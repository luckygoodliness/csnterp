<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20151125" releaseVersion="8.0.0">
<TableDataMap>
<TableData name="T1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="year"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[ERP]]></DatabaseName>
</Connection>
<Query>
<![CDATA[--T1
SELECT R.CUR_YEAR,R.TARGET,R.MONEY,R.FLAG,
       JH.MONEY_JH,
       DECODE(NVL(JH.MONEY_JH, 0), 0, 0, (NVL(R.MONEY,0)+NVL(JH.XZ,0)) / JH.MONEY_JH) AS WCBL
  FROM (SELECT R.CUR_YEAR,
               R.TARGET,
               SUM(MONEY) AS MONEY,
               DECODE(R.TARGET,
                      '合同额',
                      '1',
                      '立项利润',
                      '2',
                      '收款',
                      '3',
                      '结算收入',
                      '4',
                      '结算利润',
                      '5',
                      '6') AS FLAG
          FROM (SELECT D.ORG_CODE,
                       D.CUR_YEAR,
                       D. CUR_MONTH,
                       '合同额' AS TARGET,
                       NVL2(SUM(D.CONTRACT_MONEY),
                            SUM(D.CONTRACT_MONEY) / 10000,
                            0) AS MONEY --合同额
                  FROM (SELECT P.EXAM_DATE,
                               P.CONTRACT_SIGN_MONEY AS CONTRACT_MONEY,
                               P.CONTRACTOR_OFFICE AS ORG_CODE,
                               TO_CHAR(NVL(EXAM_DATE, SYSDATE), 'yyyy') AS CUR_YEAR,
                               TO_CHAR(NVL(EXAM_DATE, SYSDATE), 'mm') AS CUR_MONTH
                          FROM PRM_CONTRACT P
                         WHERE NVL(P.PROJECT_SOURCE_TYPE, 0) <> '4'
                         AND P.PRM_CODE_TYPE<>'JI_GAI'
                         AND TO_CHAR(P.CREATE_TIME,'yyyy')<=${year}) D
                --WHERE D.CUR_YEAR >= TO_CHAR(SYSDATE, 'yyyy')
                 GROUP BY D.ORG_CODE, D.CUR_YEAR, D. CUR_MONTH
                UNION ALL --立项利润
                SELECT D.ORG_CODE,
                       D.CUR_YEAR,
                       D. CUR_MONTH,
                       '立项利润' AS TARGET,
                       NVL2(SUM(D.PROFIT_MONEY),
                            SUM(D.PROFIT_MONEY) / 10000,
                            0) AS MONEY --立项利润
                  FROM (SELECT R.ORG_CODE,
                               R.PRM_PROJECT_MAIN_ID,
                               R.CUR_YEAR,
                               R.CUR_MONTH,
                               (NVL(R.PROFIT, 0) - NVL(R.PROFIT_L, 0)) AS PROFIT_MONEY
                          FROM (SELECT R.UUID,
                                       R.ORG_CODE,
                                       R.PRM_PROJECT_MAIN_ID,
                                       R.CUR_YEAR,
                                       R.CUR_MONTH,
                                       PROFIT,
                                       LEAD(R.PROFIT) OVER(PARTITION BY R.PRM_PROJECT_MAIN_ID ORDER BY R.CUR_YEAR DESC, R.CUR_MONTH DESC) AS PROFIT_L
                                  FROM (SELECT R.*,
                                               ROW_NUMBER() OVER(PARTITION BY R.PRM_PROJECT_MAIN_ID, R.CUR_YEAR, R.CUR_MONTH ORDER BY R.CUR_TIME DESC) ROW_NUM
                                          FROM (SELECT PPMC.UUID,
                                                       PPMC.CONTRACTOR_OFFICE AS ORG_CODE,
                                                       PPMC.PRM_PROJECT_MAIN_ID,
                                                       TO_CHAR(PPMC.EXAM_DATE,
                                                               'yyyy') AS CUR_YEAR,
                                                       TO_CHAR(PPMC.EXAM_DATE,
                                                               'mm') AS CUR_MONTH,
                                                       PPMC.EXAM_DATE AS CUR_TIME,
                                                       NVL(PPMC.PROJECT_MONEY, 0) -
                                                       NVL(PPMC.COST_CONTROL_MONEY,
                                                           0) AS PROFIT
                                                  FROM PRM_PROJECT_MAIN_C PPMC
                                                  WHERE  PPMC.STATE = 2
                                                   AND PPMC.PRM_CODE_TYPE<>'JI_GAI'
                                                   AND (SUBSTR(PPMC.PROJECT_CODE, 1, 1)<> '研' OR SUBSTR(PPMC.PROJECT_CODE, 7, 2) = 'KY' )--不含外部研发
                                                   AND NVL(PPMC.IS_PRE_PROJECT, 0) = 0
                                                   AND PPMC.ESTABLISH_DATE >=
                                                       TO_DATE('2014-06-01',
                                                               'yyyy-MM-dd')) R) R
                                 WHERE R.ROW_NUM = 1) R) D
                --WHERE D.CUR_YEAR >= TO_CHAR(SYSDATE, 'yyyy')
                 GROUP BY D.ORG_CODE, D.CUR_YEAR, D. CUR_MONTH
                UNION ALL --收款
                SELECT R.ORG_CODE,
                       R.CUR_YEAR,
                       R.CUR_MONTH,
                       '收款' AS TARGET,
                       NVL2(SUM(R.ACTUAL_MONEY),
                            SUM(R.ACTUAL_MONEY) / 10000,
                            0) AS MONEY --收款
                  FROM (SELECT M.CONTRACTOR_OFFICE AS ORG_CODE,
                               T.ACTUAL_MONEY,
                               T.EXAM_DATE,
                               TO_CHAR(T.EXAM_DATE, 'yyyy') AS CUR_YEAR,
                               TO_CHAR(T.EXAM_DATE, 'mm') AS CUR_MONTH
                          FROM PRM_RECEIPTS T, PRM_PROJECT_MAIN M
                         WHERE T.PRM_PROJECT_MAIN_ID = M.UUID
                           AND T.STATE IN ('2', '4', '8')) R
                --WHERE R.CUR_YEAR = TO_CHAR(SYSDATE, 'yyyy')
                 GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH
                UNION ALL
                --收入
                SELECT PPM.CONTRACTOR_OFFICE AS ORG_CODE,
                       JS.CUR_YEAR,
                       JS.CUR_MONTH,
                       '结算收入' AS TARGET,
                       SUM(JSSR) / 10000 AS MONEY
                  FROM (SELECT PROJECT_ID,
                               CUR_YEAR,
                               CUR_MONTH,
                               SUM(JSSR) AS JSSR
                          FROM (SELECT T.PRM_PROJECT_MAIN_ID AS PROJECT_ID,
                                       TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                                       TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                                       T.SQUARE_PROJECT_MONEY AS JSSR --收入
                                  FROM PRM_FINAL_ESTIMATE T
                                 WHERE T.EXAM_DATE IS NOT NULL) R
                         GROUP BY PROJECT_ID, CUR_YEAR, CUR_MONTH) JS
                  LEFT JOIN PRM_PROJECT_MAIN PPM ON PPM.UUID = JS.PROJECT_ID
                 GROUP BY PPM.CONTRACTOR_OFFICE, JS.CUR_YEAR, JS.CUR_MONTH
                
                UNION ALL
                --利润
                SELECT NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE) AS ORG_CODE,
             NVL(JS.CUR_YEAR,XZ.CUR_YEAR) AS CUR_YEAR,
             NVL(JS.CUR_MONTH,XZ.CUR_MONTH) AS CUR_MONTH,
                       '结算利润' AS TARGET,
                       SUM(NVL(JSLR, 0) - NVL(SJXZ, 0)) / 10000 AS JSLR
                  FROM (SELECT DEPARTMENT_CODE,
                               CUR_YEAR,
                               CUR_MONTH,
                               SUM(JSLR) AS JSLR
                          FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                       TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                                       TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                                       NVL(T. SQUARE_GROSS_PROFIT, 0)+
                                       NVL(T.TAX_CORRECTION, 0) AS JSLR --利润
                                  FROM PRM_FINAL_ESTIMATE T
                                 WHERE T.EXAM_DATE IS NOT NULL) R
                         GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) JS
                  FULL JOIN (SELECT DEPARTMENT_CODE,
                                    CUR_YEAR,
                                    CUR_MONTH,
                                    SUM(SJXZ) AS SJXZ
                               FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                            TO_CHAR(T.EXAM_R_TAX_DATE, 'YYYY') AS CUR_YEAR,
                                            TO_CHAR(T.EXAM_R_TAX_DATE, 'MM') AS CUR_MONTH,
                                            T.TAX_CORRECTION AS SJXZ --税金修正
                                       FROM PRM_FINAL_ESTIMATE T
                                      WHERE T.EXAM_R_TAX_DATE IS NOT NULL) R
                              GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) XZ ON JS.
                 DEPARTMENT_CODE =
                                                                              XZ.DEPARTMENT_CODE
                                                                          AND JS.
                 CUR_YEAR =
                                                                              XZ.CUR_YEAR
                                                                          AND JS.
                 CUR_MONTH =
                                                                              XZ.CUR_MONTH
                  GROUP BY NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE), NVL(JS.CUR_YEAR,XZ.CUR_YEAR), NVL(JS.CUR_MONTH,XZ.CUR_MONTH)
                UNION ALL
                --收支盈余
               SELECT R.ORG_CODE,
                      TO_CHAR(R.CUR_YEAR),
                      TO_CHAR(R.CUR_MONTH),
                      '收支盈余',
                      SUM(MONEY) AS MONEY
                 FROM (
                       SELECT NVL(QTCB.ORG_CODE, JSLR.ORG_CODE) AS ORG_CODE,
       NVL(QTCB.CUR_YEAR, JSLR.CUR_YEAR) AS CUR_YEAR,
       NVL(QTCB.CUR_MONTH, JSLR.CUR_MONTH) AS CUR_MONTH,
       '收支盈余',
       NVL(JSLR.JSLR, 0) - NVL(QTCB.MONEY, 0) AS MONEY
  FROM (SELECT R.ORG_CODE,
               TO_CHAR(R.CUR_YEAR) AS CUR_YEAR,
               (CASE WHEN R.CUR_MONTH>=10 THEN TO_CHAR(R.CUR_MONTH) ELSE '0'||TO_CHAR(R.CUR_MONTH) END) AS CUR_MONTH,
               '其他成本',
               SUM(MONEY) AS MONEY
          FROM (
                --人工费
                SELECT MLC.OFFICE_ID AS ORG_CODE,
                        MLC.YEAR AS CUR_YEAR,
                        MLC.MONTH AS CUR_MONTH,
                        SUM(MONEY) / 10000 AS MONEY
                  FROM MONITOR_LABOR_COST MLC
                 GROUP BY OFFICE_ID, MLC.YEAR, MLC.MONTH
                UNION ALL
                --其他分摊费用
                SELECT MOS.OFFICE_ID AS ORG_CODE,
                       MOS.YEAR AS CUR_YEAR,
                       MOS.MONTH AS CUR_MONTH,
                       SUM(MONEY) / 10000 AS MONEY
                  FROM MONITOR_OTHER_SHARE MOS
                 GROUP BY OFFICE_ID, MOS.YEAR, MOS.MONTH
                UNION ALL
                --非项目费用
                SELECT ORG_CODE,
                       TO_NUMBER(CUR_YEAR) AS CUR_YEAR,
                       TO_NUMBER(CUR_MONTH) AS CUR_MONTH,
                       SUM(MONEY) / 10000 AS MONEY
                  FROM (SELECT NPBH.OFFICE_ID AS ORG_CODE,
                               TO_CHAR(VBD48.CERTIFICATE_CREATE_TIME, 'yyyy') AS CUR_YEAR,
                               TO_CHAR(VBD48.CERTIFICATE_CREATE_TIME, 'mm') AS CUR_MONTH,
                               VBD48.MONEY
                          FROM (SELECT NVL(NVL(FAD_CASH_REQ_INVOICE.FAD_INVOICE_ID,
                                               SCM_CONTRACT_INVOICE.FAD_INVOICE_ID),
                                           VBD48.UUID) UUID,
                                       VBD48.CERTIFICATE_CREATE_TIME,
                                       VBD48.BUDGET_C_UUID,
                                       VBD48.SUBJECT_NAME,
                                       NVL(VBD48.MONEY, 0) MONEY
                                  FROM VW_BUDGET_DETAIL49 VBD48
                                  LEFT JOIN FAD_CASH_REQ_INVOICE ON VBD48.UUID =
                                                                    FAD_CASH_REQ_INVOICE.UUID
                                  LEFT JOIN SCM_CONTRACT_INVOICE ON VBD48.UUID =
                                                                    SCM_CONTRACT_INVOICE.UUID
                                 WHERE NVL(VBD48.IS_PROJECT, 0) != 1
                                   AND VBD48.BUDGET_C_UUID IS NOT NULL) VBD48
                          LEFT JOIN NON_PROJECT_BUDGET_C NPBC ON VBD48.BUDGET_C_UUID =
                                                                 NPBC.UUID
                          LEFT JOIN NON_PROJECT_BUDGET_H NPBH ON NPBC.HID =
                                                                 NPBH.UUID) R
                 GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH) R
         WHERE EXISTS (SELECT 1
                  FROM OPERATE_COMPANY_PLAN_H H
                  LEFT JOIN OPERATE_COMPANY_PLAN_C C ON H.UUID =
                                                        C.OPERATE_COMPANY_PLAN_H_ID
                 WHERE H.START_YEAR = R.CUR_YEAR
                   AND C.OBJECT_ID = R.ORG_CODE)
         GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH) QTCB
--结算利润
  FULL JOIN (SELECT NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE) AS ORG_CODE,
             NVL(JS.CUR_YEAR,XZ.CUR_YEAR) AS CUR_YEAR,
             NVL(JS.CUR_MONTH,XZ.CUR_MONTH) AS CUR_MONTH,
                    '结算利润' AS TARGET,
                    SUM(NVL(JSLR, 0) - NVL(SJXZ, 0)) / 10000 AS JSLR
               FROM (SELECT DEPARTMENT_CODE,
                            CUR_YEAR,
                            CUR_MONTH,
                            SUM(JSLR) AS JSLR
                       FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                    TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                                    TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                                    NVL(T. SQUARE_GROSS_PROFIT, 0)+
                                       NVL(T.TAX_CORRECTION, 0)  AS JSLR --利润
                               FROM PRM_FINAL_ESTIMATE T
                              WHERE T.EXAM_DATE IS NOT NULL) R
                      GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) JS
               FULL JOIN (SELECT DEPARTMENT_CODE,
                                CUR_YEAR,
                                CUR_MONTH,
                                SUM(SJXZ) AS SJXZ
                           FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                        TO_CHAR(T.EXAM_R_TAX_DATE, 'YYYY') AS CUR_YEAR,
                                        TO_CHAR(T.EXAM_R_TAX_DATE, 'MM') AS CUR_MONTH,
                                        T.TAX_CORRECTION AS SJXZ --税金修正
                                   FROM PRM_FINAL_ESTIMATE T
                                  WHERE T.EXAM_R_TAX_DATE IS NOT NULL) R
                          GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) XZ ON JS.
              DEPARTMENT_CODE =
                                                                          XZ.DEPARTMENT_CODE
                                                                      AND JS.
              CUR_YEAR =
                                                                          XZ.CUR_YEAR
                                                                      AND JS.
              CUR_MONTH =
                                                                          XZ.CUR_MONTH
               GROUP BY NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE), NVL(JS.CUR_YEAR,XZ.CUR_YEAR), NVL(JS.CUR_MONTH,XZ.CUR_MONTH)) JSLR ON JSLR.ORG_CODE =
                                                                                 QTCB.ORG_CODE
                                                                             AND JSLR.CUR_YEAR =
                                                                                 QTCB.CUR_YEAR
                                                                             AND JSLR.CUR_MONTH =
                                                                                 QTCB.CUR_MONTH) R
                GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH) R
              WHERE EXISTS (SELECT 1
                         FROM OPERATE_COMPANY_PLAN_H H
                         LEFT JOIN OPERATE_COMPANY_PLAN_C C ON H.UUID =
                                                               C.OPERATE_COMPANY_PLAN_H_ID
                        WHERE H.START_YEAR = R.CUR_YEAR
                          AND C.OBJECT_ID = R.ORG_CODE)
         GROUP BY R.CUR_YEAR, R.TARGET) R

  LEFT JOIN ( --指标
            SELECT JH.CUR_YEAR, JH.TARGET, SUM(MONEY_JH) AS MONEY_JH,SUM(XZ) AS XZ
               FROM (SELECT H.START_YEAR AS CUR_YEAR,
                             '合同额' AS TARGET,
                             JHHTE AS MONEY_JH, --合同额（万元）
                             (SELECT SUM(C.HTEXZ) FROM OPERATE_COMPANY_PLAN_C C WHERE C.OPERATE_COMPANY_PLAN_H_ID= H.UUID) AS XZ
                        FROM OPERATE_COMPANY_PLAN_H H
                      -- AND H.START_YEAR = TO_CHAR(SYSDATE, 'yyyy')
                      UNION ALL
                      --立项利润
                      SELECT H.START_YEAR AS CUR_YEAR,
                             '立项利润' AS TARGET,
                             JHLXLR,
                             (SELECT SUM(C.LXLRXZ) FROM OPERATE_COMPANY_PLAN_C C WHERE C.OPERATE_COMPANY_PLAN_H_ID= H.UUID) AS XZ
                        FROM OPERATE_COMPANY_PLAN_H H
                      --AND H.START_YEAR = TO_CHAR(SYSDATE, 'yyyy')
                      UNION ALL
                      --收款
                      SELECT H.START_YEAR AS CUR_YEAR, 
                              '收款' AS TARGET, JHSR,
                              0 AS XZ
                        FROM OPERATE_COMPANY_PLAN_H H
                      UNION ALL
                      --结算收入
                      SELECT H.START_YEAR AS CUR_YEAR,
                             '结算收入' AS TARGET,
                             JHJSSR,
                             0 AS XZ
                        FROM OPERATE_COMPANY_PLAN_H H
                      UNION ALL
                      --结算利润
                      SELECT H.START_YEAR AS CUR_YEAR,
                             '结算利润' AS TARGET,
                             JHJSLR,
                             0 AS XZ
                        FROM OPERATE_COMPANY_PLAN_H H
                         UNION ALL
                       --收支盈余
                      SELECT H.START_YEAR AS CUR_YEAR,
                             '收支盈余' AS TARGET,
                             SUM(NVL(C.JHSZYY,0)) AS JHSZYY,
                             0 AS XZ
                        FROM OPERATE_COMPANY_PLAN_H H
                        LEFT JOIN
                        OPERATE_COMPANY_PLAN_C C
                        ON H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
                        GROUP BY H.START_YEAR) JH
              GROUP BY JH.CUR_YEAR, JH.TARGET) JH ON R.CUR_YEAR =
                                                     JH.CUR_YEAR
                                                 AND R.TARGET = JH.TARGET
 WHERE R.CUR_YEAR = ${if(year =='',"TO_CHAR(SYSDATE, 'yyyy')","'"+year+"'")}
 ORDER BY FLAG]]></Query>
</TableData>
<TableData name="T2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="year"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="target"/>
<O>
<![CDATA[合同额]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[ERP]]></DatabaseName>
</Connection>
<Query>
<![CDATA[--T2
SELECT * FROM (SELECT NVL(R.ORG_CODE, JH.ORG_CODE) AS ORG_CODE,
       SO.SHORT_CODE AS ORG_NAME,
       SO.SEQ_NO,
       'T' AS IS_INNER,
       NVL(R.CUR_YEAR, JH.CUR_YEAR) AS CUR_YEAR,
       NVL(R.TARGET, JH.TARGET) AS TARGET,
       NVL(R.MONEY, 0) + NVL(JH.JZ, 0) AS MONEY,
       NVL(JH.JZ, 0) AS JZ,
       NVL(JH.MONEY_JH, 0) AS MONEY_JH,
       DECODE(NVL(JH.MONEY_JH, 0),
              0,
              0,
              (NVL(R.MONEY, 0) + NVL(JH.JZ, 0)) / JH.MONEY_JH) AS WCBL
  FROM (SELECT D.ORG_CODE,
               D.CUR_YEAR,
               '合同额' AS TARGET,
               NVL2(SUM(D.CONTRACT_MONEY), SUM(D.CONTRACT_MONEY) / 10000, 0) AS MONEY --合同额
          FROM (SELECT P.EXAM_DATE,
                       P.CONTRACT_SIGN_MONEY AS CONTRACT_MONEY,
                       P.CONTRACTOR_OFFICE AS ORG_CODE,
                       TO_CHAR(NVL(EXAM_DATE, SYSDATE), 'yyyy') AS CUR_YEAR,
                       TO_CHAR(NVL(EXAM_DATE, SYSDATE), 'mm') AS CUR_MONTH
                  FROM PRM_CONTRACT P
                 WHERE 
                  P.PRM_CODE_TYPE<>'JI_GAI'
                 AND NVL(P.PROJECT_SOURCE_TYPE, 0) <> '4'
                 AND TO_CHAR(P.CREATE_TIME,'yyyy')<=${year}) D
         GROUP BY D.ORG_CODE, D.CUR_YEAR
        UNION ALL --立项利润
        SELECT D.ORG_CODE,
               D.CUR_YEAR,
               '立项利润' AS TARGET,
               NVL2(SUM(D.PROFIT_MONEY), SUM(D.PROFIT_MONEY) / 10000, 0) AS MONEY --立项利润
          FROM (SELECT R.ORG_CODE,
       R.PRM_PROJECT_MAIN_ID,
       R.CUR_YEAR,
       R.CUR_MONTH,
       R.PROFIT,
       R.PROFIT_L,
       (NVL(R.PROFIT, 0) - NVL(R.PROFIT_L, 0)) AS PROFIT_MONEY
  FROM (SELECT R.UUID,
               R.ORG_CODE,
               R.PRM_PROJECT_MAIN_ID,
               R.CUR_YEAR,
               R.CUR_MONTH,
               PROFIT,
               LEAD(R.PROFIT) OVER(PARTITION BY R.PRM_PROJECT_MAIN_ID ORDER BY R.CUR_YEAR DESC, R.CUR_MONTH DESC) AS PROFIT_L
          FROM (SELECT R.*,
                       ROW_NUMBER() OVER(PARTITION BY R.PRM_PROJECT_MAIN_ID, R.CUR_YEAR, R.CUR_MONTH ORDER BY R.CUR_TIME DESC) ROW_NUM
                  FROM (SELECT PPMC.UUID,
                               PPMC.CONTRACTOR_OFFICE AS ORG_CODE,
                               PPMC.PRM_PROJECT_MAIN_ID,
                               TO_CHAR(PPMC.EXAM_DATE,
                                       'yyyy') AS CUR_YEAR,
                               TO_CHAR(PPMC.EXAM_DATE,
                                       'mm') AS CUR_MONTH,
                               PPMC.EXAM_DATE AS CUR_TIME,
                               NVL(PPMC.PROJECT_MONEY, 0) -
                               NVL(PPMC.COST_CONTROL_MONEY, 0) AS PROFIT
                          FROM PRM_PROJECT_MAIN_C PPMC
                          WHERE PPMC.STATE = 2
                           AND PPMC.PRM_CODE_TYPE<>'JI_GAI'
                           AND (SUBSTR(PPMC.PROJECT_CODE, 1, 1)<> '研' OR SUBSTR(PPMC.PROJECT_CODE, 7, 2) = 'KY' )--不含外部研发
                           AND NVL(PPMC.IS_PRE_PROJECT, 0) = 0
                           AND PPMC.ESTABLISH_DATE >=
                               TO_DATE('2014-06-01', 'yyyy-MM-dd')) R) R
         WHERE R.ROW_NUM = 1) R) D
         GROUP BY D.ORG_CODE, D.CUR_YEAR
        UNION ALL --收款
        SELECT R.ORG_CODE,
               R.CUR_YEAR,
               '收款' AS TARGET,
               NVL2(SUM(R.ACTUAL_MONEY), SUM(R.ACTUAL_MONEY) / 10000, 0) AS MONEY --收款
          FROM (SELECT M.CONTRACTOR_OFFICE AS ORG_CODE,
                       T.ACTUAL_MONEY,
                       T.EXAM_DATE,
                       TO_CHAR(T.EXAM_DATE, 'yyyy') AS CUR_YEAR,
                       TO_CHAR(T.EXAM_DATE, 'mm') AS CUR_MONTH
                  FROM PRM_RECEIPTS T, PRM_PROJECT_MAIN M
                 WHERE T.PRM_PROJECT_MAIN_ID = M.UUID
                   AND T.STATE IN ('2', '4', '8')) R
         GROUP BY R.ORG_CODE, R.CUR_YEAR
        UNION ALL
        --收入
        SELECT PPM.CONTRACTOR_OFFICE AS ORG_CODE,
               JS.CUR_YEAR,
               '结算收入' AS TARGET,
               SUM(JSSR) / 10000 AS MONEY
          FROM (SELECT PROJECT_ID, CUR_YEAR, CUR_MONTH, SUM(JSSR) AS JSSR
                  FROM (SELECT T.PRM_PROJECT_MAIN_ID AS PROJECT_ID,
                               TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                               TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                               T.SQUARE_PROJECT_MONEY AS JSSR --收入
                          FROM PRM_FINAL_ESTIMATE T
                         WHERE T.EXAM_DATE IS NOT NULL) R
                 GROUP BY PROJECT_ID, CUR_YEAR, CUR_MONTH) JS
          LEFT JOIN PRM_PROJECT_MAIN PPM ON PPM.UUID = JS.PROJECT_ID
          WHERE SUBSTR(PPM.PROJECT_CODE, 0, 1)<>'研'
         GROUP BY PPM.CONTRACTOR_OFFICE, JS.CUR_YEAR
        
        UNION ALL
        --利润
        SELECT NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE) AS ORG_CODE,
           NVL(JS.CUR_YEAR,XZ.CUR_YEAR) AS CUR_YEAR,
               '结算利润' AS TARGET,
               SUM(NVL(JSLR, 0) - NVL(SJXZ, 0)) / 10000 AS JSLR
          FROM (SELECT DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH, SUM(JSLR) AS JSLR
                  FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                               TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                               TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                               NVL(T. SQUARE_GROSS_PROFIT, 0)+
                                       NVL(T.TAX_CORRECTION, 0)  AS JSLR --利润
                          FROM PRM_FINAL_ESTIMATE T
                         WHERE T.EXAM_DATE IS NOT NULL
                          AND NOT EXISTS
              (SELECT 1
                       FROM PRM_PROJECT_MAIN PPM
                      WHERE PPM.UUID = T.PRM_PROJECT_MAIN_ID
                        AND SUBSTR(PPM.PROJECT_CODE, 0, 1) = '研')) R
                 GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) JS
          FULL JOIN (SELECT DEPARTMENT_CODE,
                            CUR_YEAR,
                            CUR_MONTH,
                            SUM(SJXZ) AS SJXZ
                       FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                    TO_CHAR(T.EXAM_R_TAX_DATE, 'YYYY') AS CUR_YEAR,
                                    TO_CHAR(T.EXAM_R_TAX_DATE, 'MM') AS CUR_MONTH,
                                    T.TAX_CORRECTION AS SJXZ --税金修正
                               FROM PRM_FINAL_ESTIMATE T
                              WHERE T.EXAM_R_TAX_DATE IS NOT NULL
                               AND NOT EXISTS
              (SELECT 1
                       FROM PRM_PROJECT_MAIN PPM
                      WHERE PPM.UUID = T.PRM_PROJECT_MAIN_ID
                        AND SUBSTR(PPM.PROJECT_CODE, 0, 1) = '研')) R
                      GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) XZ ON JS.
         DEPARTMENT_CODE =
                                                                      XZ.DEPARTMENT_CODE
                                                                  AND JS.
         CUR_YEAR =
                                                                      XZ.CUR_YEAR
                                                                  AND JS.
         CUR_MONTH =
                                                                      XZ.CUR_MONTH
          GROUP BY NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE), NVL(JS.CUR_YEAR,XZ.CUR_YEAR)
        UNION ALL
        --收支盈余
        SELECT R.ORG_CODE,
               TO_CHAR(R.CUR_YEAR),
               '收支盈余',
               SUM(MONEY) AS MONEY
          FROM (
                --人工费
                SELECT NVL(QTCB.ORG_CODE, JSLR.ORG_CODE) AS ORG_CODE,
       NVL(QTCB.CUR_YEAR, JSLR.CUR_YEAR) AS CUR_YEAR,
       NVL(QTCB.CUR_MONTH, JSLR.CUR_MONTH) AS CUR_MONTH,
       '收支盈余',
       NVL(JSLR.JSLR, 0) - NVL(QTCB.MONEY, 0) AS MONEY
  FROM (SELECT R.ORG_CODE,
               TO_CHAR(R.CUR_YEAR) AS CUR_YEAR,
               (CASE WHEN R.CUR_MONTH>=10 THEN TO_CHAR(R.CUR_MONTH) ELSE '0'||TO_CHAR(R.CUR_MONTH) END) AS CUR_MONTH,
               '其他成本',
               SUM(MONEY) AS MONEY
          FROM (
                --人工费
                SELECT MLC.OFFICE_ID AS ORG_CODE,
                        MLC.YEAR AS CUR_YEAR,
                        MLC.MONTH AS CUR_MONTH,
                        SUM(MONEY) / 10000 AS MONEY
                  FROM MONITOR_LABOR_COST MLC
                 GROUP BY OFFICE_ID, MLC.YEAR, MLC.MONTH
                UNION ALL
                --其他分摊费用
                SELECT MOS.OFFICE_ID AS ORG_CODE,
                       MOS.YEAR AS CUR_YEAR,
                       MOS.MONTH AS CUR_MONTH,
                       SUM(MONEY) / 10000 AS MONEY
                  FROM MONITOR_OTHER_SHARE MOS
                 GROUP BY OFFICE_ID, MOS.YEAR, MOS.MONTH
                UNION ALL
                --非项目费用
                SELECT ORG_CODE,
                       TO_NUMBER(CUR_YEAR) AS CUR_YEAR,
                       TO_NUMBER(CUR_MONTH) AS CUR_MONTH,
                       SUM(MONEY) / 10000 AS MONEY
                  FROM (SELECT NPBH.OFFICE_ID AS ORG_CODE,
                               TO_CHAR(VBD48.CERTIFICATE_CREATE_TIME, 'yyyy') AS CUR_YEAR,
                               TO_CHAR(VBD48.CERTIFICATE_CREATE_TIME, 'mm') AS CUR_MONTH,
                               VBD48.MONEY
                          FROM (SELECT NVL(NVL(FAD_CASH_REQ_INVOICE.FAD_INVOICE_ID,
                                               SCM_CONTRACT_INVOICE.FAD_INVOICE_ID),
                                           VBD48.UUID) UUID,
                                       VBD48.CERTIFICATE_CREATE_TIME,
                                       VBD48.BUDGET_C_UUID,
                                       VBD48.SUBJECT_NAME,
                                       NVL(VBD48.MONEY, 0) MONEY
                                  FROM VW_BUDGET_DETAIL49 VBD48
                                  LEFT JOIN FAD_CASH_REQ_INVOICE ON VBD48.UUID =
                                                                    FAD_CASH_REQ_INVOICE.UUID
                                  LEFT JOIN SCM_CONTRACT_INVOICE ON VBD48.UUID =
                                                                    SCM_CONTRACT_INVOICE.UUID
                                 WHERE NVL(VBD48.IS_PROJECT, 0) != 1
                                   AND VBD48.BUDGET_C_UUID IS NOT NULL) VBD48
                          LEFT JOIN NON_PROJECT_BUDGET_C NPBC ON VBD48.BUDGET_C_UUID =
                                                                 NPBC.UUID
                          LEFT JOIN NON_PROJECT_BUDGET_H NPBH ON NPBC.HID =
                                                                 NPBH.UUID) R
                 GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH) R
         WHERE EXISTS (SELECT 1
                  FROM OPERATE_COMPANY_PLAN_H H
                  LEFT JOIN OPERATE_COMPANY_PLAN_C C ON H.UUID =
                                                        C.OPERATE_COMPANY_PLAN_H_ID
                 WHERE H.START_YEAR = R.CUR_YEAR
                   AND C.OBJECT_ID = R.ORG_CODE)
         GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH) QTCB
--结算利润
  FULL JOIN (SELECT NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE) AS ORG_CODE,
             NVL(JS.CUR_YEAR,XZ.CUR_YEAR) AS CUR_YEAR,
             NVL(JS.CUR_MONTH,XZ.CUR_MONTH) AS CUR_MONTH,
                    '结算利润' AS TARGET,
                    SUM(NVL(JSLR, 0) - NVL(SJXZ, 0)) / 10000 AS JSLR
               FROM (SELECT DEPARTMENT_CODE,
                            CUR_YEAR,
                            CUR_MONTH,
                            SUM(JSLR) AS JSLR
                       FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                    TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                                    TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                                    NVL(T. SQUARE_GROSS_PROFIT, 0)+
                                       NVL(T.TAX_CORRECTION, 0) AS JSLR --利润
                               FROM PRM_FINAL_ESTIMATE T
                              WHERE T.EXAM_DATE IS NOT NULL
                              AND NOT EXISTS
              (SELECT 1
                       FROM PRM_PROJECT_MAIN PPM
                      WHERE PPM.UUID = T.PRM_PROJECT_MAIN_ID
                        AND SUBSTR(PPM.PROJECT_CODE, 0, 1) = '研')) R
                      GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) JS
               FULL JOIN (SELECT DEPARTMENT_CODE,
                                CUR_YEAR,
                                CUR_MONTH,
                                SUM(SJXZ) AS SJXZ
                           FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                        TO_CHAR(T.EXAM_R_TAX_DATE, 'YYYY') AS CUR_YEAR,
                                        TO_CHAR(T.EXAM_R_TAX_DATE, 'MM') AS CUR_MONTH,
                                        T.TAX_CORRECTION AS SJXZ --税金修正
                                   FROM PRM_FINAL_ESTIMATE T
                                  WHERE T.EXAM_R_TAX_DATE IS NOT NULL
                                  AND NOT EXISTS
              (SELECT 1
                       FROM PRM_PROJECT_MAIN PPM
                      WHERE PPM.UUID = T.PRM_PROJECT_MAIN_ID
                        AND SUBSTR(PPM.PROJECT_CODE, 0, 1) = '研')) R
                          GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) XZ ON JS.
              DEPARTMENT_CODE =
                                                                          XZ.DEPARTMENT_CODE
                                                                      AND JS.
              CUR_YEAR =
                                                                          XZ.CUR_YEAR
                                                                      AND JS.
              CUR_MONTH =
                                                                          XZ.CUR_MONTH
              GROUP BY NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE), NVL(JS.CUR_YEAR,XZ.CUR_YEAR), NVL(JS.CUR_MONTH,XZ.CUR_MONTH)) JSLR ON JSLR.ORG_CODE =
                                                                                 QTCB.ORG_CODE
                                                                             AND JSLR.CUR_YEAR =
                                                                                 QTCB.CUR_YEAR
                                                                             AND JSLR.CUR_MONTH =
                                                                                 QTCB.CUR_MONTH
                 
                 ) R
         GROUP BY R.ORG_CODE, R.CUR_YEAR) R

 RIGHT JOIN ( --指标
             SELECT OBJECT_ID AS ORG_CODE,
                     H.START_YEAR AS CUR_YEAR,
                     '合同额' AS TARGET,
                     C.JHHTE AS MONEY_JH, --合同额（万元）
                     NVL(C.JZHTE,0)+NVL(C.HTEXZ,0) AS JZ --结转+修正
               FROM OPERATE_COMPANY_PLAN_H H, OPERATE_COMPANY_PLAN_C C
              WHERE H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
             UNION ALL
             --立项利润
             SELECT OBJECT_ID AS ORG_CODE,
                    H.START_YEAR AS CUR_YEAR,
                    '立项利润' AS TARGET,
                    C.JHLXLR,
                    NVL(C.JZLR,0)+NVL(C.lxlrxz,0) AS JZ --结转+修正
               FROM OPERATE_COMPANY_PLAN_H H, OPERATE_COMPANY_PLAN_C C
              WHERE H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
             UNION ALL
             --收款
             SELECT OBJECT_ID AS ORG_CODE,
                    H.START_YEAR AS CUR_YEAR,
                    '收款' AS TARGET,
                    C.JHSR,
                    NVL(JZSR,0)+NVL(BMSRXZ,0) AS JZ --结转+修正
               FROM OPERATE_COMPANY_PLAN_H H, OPERATE_COMPANY_PLAN_C C
              WHERE H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
             UNION ALL
             --结算收入
             SELECT OBJECT_ID AS ORG_CODE,
                    H.START_YEAR AS CUR_YEAR,
                    '结算收入' AS TARGET,
                    C.JHJSSR,
                    BMJSSRXZ AS JZ --结转+修正
               FROM OPERATE_COMPANY_PLAN_H H, OPERATE_COMPANY_PLAN_C C
              WHERE H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
             UNION ALL
             --结算利润
             SELECT OBJECT_ID AS ORG_CODE,
                    H.START_YEAR AS CUR_YEAR,
                    '结算利润' AS TARGET,
                    C.JHJSLR,
                    BMJSLRXZ AS JZ --结转+修正
               FROM OPERATE_COMPANY_PLAN_H H, OPERATE_COMPANY_PLAN_C C
              WHERE H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
             UNION ALL
             --收支盈余
             SELECT OBJECT_ID AS ORG_CODE,
                    H.START_YEAR AS CUR_YEAR,
                    '收支盈余' AS TARGET,
                    C.JHSZYY,
                    BMJSLRXZ AS JZ --结转+修正
               FROM OPERATE_COMPANY_PLAN_H H, OPERATE_COMPANY_PLAN_C C
              WHERE H.UUID = C.OPERATE_COMPANY_PLAN_H_ID) JH ON R.ORG_CODE =
                                                                JH.ORG_CODE
                                                            AND R.CUR_YEAR =
                                                                JH.CUR_YEAR
                                                            AND R.TARGET =
                                                                JH.TARGET
  LEFT JOIN (SELECT SO.SHORT_CODE,SO.ORG_CODE,DECODE(SO.ORG_CODE,'CSNT_ZCB','9999',SO.SEQ_NO) AS SEQ_NO  FROM  SCDP_ORG SO) SO ON SO.ORG_CODE = NVL(R.ORG_CODE, JH.ORG_CODE)
 )R
 WHERE R.CUR_YEAR = ${if(year =='',"TO_CHAR(SYSDATE, 'yyyy')","'"+year+"'")}
   AND R.TARGET = '${target}'
 ORDER BY R.SEQ_NO,NVL(R.IS_INNER, 0) DESC]]></Query>
</TableData>
<TableData name="T3" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="year"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="target"/>
<O>
<![CDATA[合同额]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[ERP]]></DatabaseName>
</Connection>
<Query>
<![CDATA[--T3
SELECT
*
FROM
(
SELECT
NVL(THIS_YEAR.CUR_YEAR ,LAST_YEAR.CUR_YEAR) CUR_YEAR,
NVL(THIS_YEAR.CUR_MONTH ,LAST_YEAR.CUR_MONTH) CUR_MONTH,
NVL(THIS_YEAR.MONTHS ,LAST_YEAR.MONTHS) MONTHS,
NVL(THIS_YEAR.TARGET ,LAST_YEAR.TARGET) TARGET,
NVL(THIS_YEAR.FLAG ,LAST_YEAR.FLAG) FLAG,

NVL(THIS_YEAR.MONEY, 0) MONEY,
SUM(NVL(THIS_YEAR.MONEY, 0)) OVER(PARTITION BY NVL(THIS_YEAR.TARGET ,LAST_YEAR.TARGET) ORDER BY NVL(THIS_YEAR.MONTHS ,LAST_YEAR.MONTHS) ROWS BETWEEN 12 PRECEDING AND 0 FOLLOWING) MONEY_LJ,

NVL(LAST_YEAR.MONEY, 0) L_MONEY,
NVL(LAST_YEAR.MONEY_LJ, 0) L_MONEY_LJ
FROM
(
SELECT R.*, SUM(R.MONEY) OVER(PARTITION BY R.TARGET ORDER BY MONTHS ROWS BETWEEN 12 PRECEDING AND 0 FOLLOWING) AS MONEY_LJ
  FROM (SELECT R.CUR_YEAR,
               R. CUR_MONTH || '月' AS CUR_MONTH,
               TO_NUMBER(R.CUR_MONTH) AS MONTHS,
               TARGET,
               DECODE(R.TARGET,
                      '合同额',
                      '1',
                      '立项利润',
                      '2',
                      '收款',
                      '3',
                      '结算收入',
                      '4',
                      '结算利润',
                      '5',
                      '6') AS FLAG,
               SUM(R.MONEY) AS MONEY
          FROM (SELECT SJFS.ORG_CODE,
SJFS.CUR_YEAR,
SJFS.CUR_MONTH,
SJFS.TARGET,
NVL(SJFS.MONEY,0)+NVL(XZ.XZ,0) AS MONEY
FROM  (SELECT * FROM (SELECT D.ORG_CODE,
                       D.CUR_YEAR,
                       D. CUR_MONTH,
                       '合同额' AS TARGET,
                       NVL2(SUM(D.CONTRACT_MONEY),
                            SUM(D.CONTRACT_MONEY) / 10000,
                            0) AS MONEY --合同额
                  FROM (SELECT P.CONFIRMED_DATE,
                               P.CONTRACT_SIGN_MONEY AS CONTRACT_MONEY,
                               P.CONTRACTOR_OFFICE AS ORG_CODE,
                  TO_CHAR(NVL(EXAM_DATE, SYSDATE), 'yyyy') AS CUR_YEAR,
                  TO_CHAR(NVL(EXAM_DATE, SYSDATE), 'mm') AS CUR_MONTH
                          FROM PRM_CONTRACT P
                         WHERE NVL(P.PROJECT_SOURCE_TYPE, 0) <> '4'
            AND P.PRM_CODE_TYPE<>'JI_GAI'
            AND TO_CHAR(P.CREATE_TIME,'yyyy')<=${year}) D
                --WHERE D.CUR_YEAR >= TO_CHAR(SYSDATE, 'yyyy')
                 GROUP BY D.ORG_CODE, D.CUR_YEAR, D. CUR_MONTH
                UNION ALL --立项利润
                SELECT D.ORG_CODE,
                       D.CUR_YEAR,
                       D. CUR_MONTH,
                       '立项利润' AS TARGET,
                       NVL2(SUM(D.PROFIT_MONEY),
                            SUM(D.PROFIT_MONEY) / 10000,
                            0) AS MONEY --立项利润
                  FROM (SELECT R.ORG_CODE,
       R.PRM_PROJECT_MAIN_ID,
       R.CUR_YEAR,
       R.CUR_MONTH,
       R.PROFIT,
       R.PROFIT_L,
       (NVL(R.PROFIT, 0) - NVL(R.PROFIT_L, 0)) AS PROFIT_MONEY
  FROM (SELECT R.UUID,
               R.ORG_CODE,
               R.PRM_PROJECT_MAIN_ID,
               R.CUR_YEAR,
               R.CUR_MONTH,
               PROFIT,
               LEAD(R.PROFIT) OVER(PARTITION BY R.PRM_PROJECT_MAIN_ID ORDER BY R.CUR_YEAR DESC, R.CUR_MONTH DESC) AS PROFIT_L
          FROM (SELECT R.*,
                       ROW_NUMBER() OVER(PARTITION BY R.PRM_PROJECT_MAIN_ID, R.CUR_YEAR, R.CUR_MONTH ORDER BY R.CUR_TIME DESC) ROW_NUM
                  FROM (SELECT PPMC.UUID,
                               PPMC.CONTRACTOR_OFFICE AS ORG_CODE,
                               PPMC.PRM_PROJECT_MAIN_ID,
                               TO_CHAR(PPMC.EXAM_DATE,
                                       'yyyy') AS CUR_YEAR,
                               TO_CHAR(PPMC.EXAM_DATE,
                                       'mm') AS CUR_MONTH,
                               PPMC.EXAM_DATE AS CUR_TIME,
                               NVL(PPMC.PROJECT_MONEY, 0) -
                               NVL(PPMC.COST_CONTROL_MONEY, 0) AS PROFIT
                          FROM PRM_PROJECT_MAIN_C PPMC
                          WHERE  PPMC.STATE = 2
                           AND PPMC.PRM_CODE_TYPE<>'JI_GAI'
                           AND (SUBSTR(PPMC.PROJECT_CODE, 1, 1)<> '研' OR SUBSTR(PPMC.PROJECT_CODE, 7, 2) = 'KY' )--不含外部研发
                           AND NVL(PPMC.IS_PRE_PROJECT, 0) = 0
                           AND PPMC.ESTABLISH_DATE >=
                               TO_DATE('2014-06-01', 'yyyy-MM-dd')) R) R
         WHERE R.ROW_NUM = 1) R
) D
                --WHERE D.CUR_YEAR >= TO_CHAR(SYSDATE, 'yyyy')
                 GROUP BY D.ORG_CODE, D.CUR_YEAR, D. CUR_MONTH
                UNION ALL --收款
                SELECT R.ORG_CODE,
                       R.CUR_YEAR,
                       R.CUR_MONTH,
                       '收款' AS TARGET,
                       NVL2(SUM(R.ACTUAL_MONEY),
                            SUM(R.ACTUAL_MONEY) / 10000,
                            0) AS MONEY --收款
                  FROM (SELECT M.CONTRACTOR_OFFICE AS ORG_CODE,
                               T.ACTUAL_MONEY,
                               T.EXAM_DATE,
                               TO_CHAR(T.EXAM_DATE, 'yyyy') AS CUR_YEAR,
                               TO_CHAR(T.EXAM_DATE, 'mm') AS CUR_MONTH
                          FROM PRM_RECEIPTS T, PRM_PROJECT_MAIN M
                         WHERE T.PRM_PROJECT_MAIN_ID = M.UUID
                           AND T.STATE IN ('2', '4', '8')) R
                -- WHERE R.CUR_YEAR = TO_CHAR(SYSDATE, 'yyyy')
                 GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH
                UNION ALL
                --收入
                SELECT PPM.CONTRACTOR_OFFICE AS ORG_CODE,
                       JS.CUR_YEAR,
                       JS.CUR_MONTH,
                       '结算收入' AS TARGET,
                       SUM(JSSR) / 10000 AS MONEY
                  FROM (SELECT PROJECT_ID,
                               CUR_YEAR,
                               CUR_MONTH,
                               SUM(JSSR) AS JSSR
                          FROM (SELECT T.PRM_PROJECT_MAIN_ID AS PROJECT_ID,
                                       TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                                       TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                                       T.SQUARE_PROJECT_MONEY AS JSSR --收入
                                  FROM PRM_FINAL_ESTIMATE T
                                 WHERE T.EXAM_DATE IS NOT NULL) R
                         GROUP BY PROJECT_ID, CUR_YEAR, CUR_MONTH) JS
                  LEFT JOIN PRM_PROJECT_MAIN PPM ON PPM.UUID = JS.PROJECT_ID
                 GROUP BY PPM.CONTRACTOR_OFFICE, JS.CUR_YEAR, JS.CUR_MONTH
                
                UNION ALL
                --利润
                SELECT NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE) AS ORG_CODE,
               NVL(JS.CUR_YEAR,XZ.CUR_YEAR) AS CUR_YEAR,
               NVL(JS.CUR_MONTH,XZ.CUR_MONTH) AS CUR_MONTH,
                       '结算利润' AS TARGET,
                       SUM(NVL(JSLR, 0) - NVL(SJXZ, 0)) / 10000 AS JSLR
                  FROM (SELECT DEPARTMENT_CODE,
                               CUR_YEAR,
                               CUR_MONTH,
                               SUM(JSLR) AS JSLR
                          FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                       TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                                       TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                                       NVL(T. SQUARE_GROSS_PROFIT, 0)+
                                       NVL(T.TAX_CORRECTION, 0)  AS JSLR --利润
                                  FROM PRM_FINAL_ESTIMATE T
                                 WHERE T.EXAM_DATE IS NOT NULL) R
                         GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) JS
                  FULL JOIN (SELECT DEPARTMENT_CODE,
                                    CUR_YEAR,
                                    CUR_MONTH,
                                    SUM(SJXZ) AS SJXZ
                               FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                            TO_CHAR(T.EXAM_R_TAX_DATE, 'YYYY') AS CUR_YEAR,
                                            TO_CHAR(T.EXAM_R_TAX_DATE, 'MM') AS CUR_MONTH,
                                            T.TAX_CORRECTION AS SJXZ --税金修正
                                       FROM PRM_FINAL_ESTIMATE T
                                      WHERE T.EXAM_R_TAX_DATE IS NOT NULL) R
                              GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) XZ ON JS.
                 DEPARTMENT_CODE =
                                                                              XZ.DEPARTMENT_CODE
                                                                          AND JS.
                 CUR_YEAR =
                                                                              XZ.CUR_YEAR
                                                                          AND JS.
                 CUR_MONTH =
                                                                              XZ.CUR_MONTH
                  GROUP BY NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE), NVL(JS.CUR_YEAR,XZ.CUR_YEAR), NVL(JS.CUR_MONTH,XZ.CUR_MONTH)
                UNION ALL
                --收支盈余
                 SELECT R.ORG_CODE,
               TO_CHAR(R.CUR_YEAR) AS CUR_YEAR,
               TO_CHAR(R.CUR_MONTH) ASCUR_MONTH,
               '收支盈余'AS TARGET,
               SUM(MONEY) AS MONEY
          FROM (
                --人工费
               SELECT NVL(QTCB.ORG_CODE, JSLR.ORG_CODE) AS ORG_CODE,
       NVL(QTCB.CUR_YEAR, JSLR.CUR_YEAR) AS CUR_YEAR,
       NVL(QTCB.CUR_MONTH, JSLR.CUR_MONTH) AS CUR_MONTH,
       '收支盈余',
       NVL(JSLR.JSLR, 0) - NVL(QTCB.MONEY, 0) AS MONEY
  FROM (SELECT R.ORG_CODE,
               TO_CHAR(R.CUR_YEAR) AS CUR_YEAR,
               (CASE WHEN R.CUR_MONTH>=10 THEN TO_CHAR(R.CUR_MONTH) ELSE '0'||TO_CHAR(R.CUR_MONTH) END) AS CUR_MONTH,
               '其他成本',
               SUM(MONEY) AS MONEY
          FROM (
                --人工费
                SELECT MLC.OFFICE_ID AS ORG_CODE,
                        MLC.YEAR AS CUR_YEAR,
                        MLC.MONTH AS CUR_MONTH,
                        SUM(MONEY) / 10000 AS MONEY
                  FROM MONITOR_LABOR_COST MLC
                 GROUP BY OFFICE_ID, MLC.YEAR, MLC.MONTH
                UNION ALL
                --其他分摊费用
                SELECT MOS.OFFICE_ID AS ORG_CODE,
                       MOS.YEAR AS CUR_YEAR,
                       MOS.MONTH AS CUR_MONTH,
                       SUM(MONEY) / 10000 AS MONEY
                  FROM MONITOR_OTHER_SHARE MOS
                 GROUP BY OFFICE_ID, MOS.YEAR, MOS.MONTH
                UNION ALL
                --非项目费用
                SELECT ORG_CODE,
                       TO_NUMBER(CUR_YEAR) AS CUR_YEAR,
                       TO_NUMBER(CUR_MONTH) AS CUR_MONTH,
                       SUM(MONEY) / 10000 AS MONEY
                  FROM (SELECT NPBH.OFFICE_ID AS ORG_CODE,
                               TO_CHAR(VBD48.CERTIFICATE_CREATE_TIME, 'yyyy') AS CUR_YEAR,
                               TO_CHAR(VBD48.CERTIFICATE_CREATE_TIME, 'mm') AS CUR_MONTH,
                               VBD48.MONEY
                          FROM (SELECT NVL(NVL(FAD_CASH_REQ_INVOICE.FAD_INVOICE_ID,
                                               SCM_CONTRACT_INVOICE.FAD_INVOICE_ID),
                                           VBD48.UUID) UUID,
                                       VBD48.CERTIFICATE_CREATE_TIME,
                                       VBD48.BUDGET_C_UUID,
                                       VBD48.SUBJECT_NAME,
                                       NVL(VBD48.MONEY, 0) MONEY
                                  FROM VW_BUDGET_DETAIL49 VBD48
                                  LEFT JOIN FAD_CASH_REQ_INVOICE ON VBD48.UUID =
                                                                    FAD_CASH_REQ_INVOICE.UUID
                                  LEFT JOIN SCM_CONTRACT_INVOICE ON VBD48.UUID =
                                                                    SCM_CONTRACT_INVOICE.UUID
                                 WHERE NVL(VBD48.IS_PROJECT, 0) != 1
                                   AND VBD48.BUDGET_C_UUID IS NOT NULL) VBD48
                          LEFT JOIN NON_PROJECT_BUDGET_C NPBC ON VBD48.BUDGET_C_UUID =
                                                                 NPBC.UUID
                          LEFT JOIN NON_PROJECT_BUDGET_H NPBH ON NPBC.HID =
                                                                 NPBH.UUID) R
                 GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH) R
         GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH) QTCB
--结算利润
  FULL JOIN (SELECT  NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE) AS ORG_CODE,
             NVL(JS.CUR_YEAR,XZ.CUR_YEAR) AS CUR_YEAR,
             NVL(JS.CUR_MONTH,XZ.CUR_MONTH) AS CUR_MONTH,
                    '结算利润' AS TARGET,
                    SUM(NVL(JSLR, 0) - NVL(SJXZ, 0)) / 10000 AS JSLR
               FROM (SELECT DEPARTMENT_CODE,
                            CUR_YEAR,
                            CUR_MONTH,
                            SUM(JSLR) AS JSLR
                       FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                    TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                                    TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                                    NVL(T. SQUARE_GROSS_PROFIT, 0)+
                                       NVL(T.TAX_CORRECTION, 0) AS JSLR --利润
                               FROM PRM_FINAL_ESTIMATE T
                              WHERE T.EXAM_DATE IS NOT NULL) R
                      GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) JS
               FULL JOIN (SELECT DEPARTMENT_CODE,
                                CUR_YEAR,
                                CUR_MONTH,
                                SUM(SJXZ) AS SJXZ
                           FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                        TO_CHAR(T.EXAM_R_TAX_DATE, 'YYYY') AS CUR_YEAR,
                                        TO_CHAR(T.EXAM_R_TAX_DATE, 'MM') AS CUR_MONTH,
                                        T.TAX_CORRECTION AS SJXZ --税金修正
                                   FROM PRM_FINAL_ESTIMATE T
                                  WHERE T.EXAM_R_TAX_DATE IS NOT NULL) R
                          GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) XZ ON JS.
              DEPARTMENT_CODE =
                                                                          XZ.DEPARTMENT_CODE
                                                                      AND JS.
              CUR_YEAR =
                                                                          XZ.CUR_YEAR
                                                                      AND JS.
              CUR_MONTH =
                                                                          XZ.CUR_MONTH
               GROUP BY NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE), NVL(JS.CUR_YEAR,XZ.CUR_YEAR), NVL(JS.CUR_MONTH,XZ.CUR_MONTH)) JSLR ON JSLR.ORG_CODE =
                                                                                 QTCB.ORG_CODE
                                                                             AND JSLR.CUR_YEAR =
                                                                                 QTCB.CUR_YEAR
                                                                             AND JSLR.CUR_MONTH =
                                                                                 QTCB.CUR_MONTH
) R
         GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH)T WHERE EXISTS (SELECT 1 FROM OPERATE_COMPANY_PLAN_H H
                        LEFT JOIN
                        OPERATE_COMPANY_PLAN_C C
                        ON H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
                        WHERE H.START_YEAR=T.CUR_YEAR
                                AND C.OBJECT_ID = T.ORG_CODE) ) SJFS--实际发生
         LEFT JOIN (SELECT H.START_YEAR AS CUR_YEAR,1 AS CUR_MONTH ,C.OBJECT_ID AS ORG_CODE,'立项利润' AS TARGET, NVL(C.LXLRXZ, 0) AS XZ
  FROM OPERATE_COMPANY_PLAN_H H
  LEFT JOIN OPERATE_COMPANY_PLAN_C C ON H.UUID =
                                        C.OPERATE_COMPANY_PLAN_H_ID
                                        UNION ALL
SELECT H.START_YEAR AS CUR_YEAR,1 AS CUR_MONTH ,C.OBJECT_ID AS ORG_CODE,'合同额' AS TARGET, NVL(C.HTEXZ, 0) AS XZ
  FROM OPERATE_COMPANY_PLAN_H H
  LEFT JOIN OPERATE_COMPANY_PLAN_C C ON H.UUID =
                                        C.OPERATE_COMPANY_PLAN_H_ID
                                        )XZ --修正值
ON XZ.CUR_YEAR=SJFS.CUR_YEAR AND  XZ.CUR_MONTH=SJFS.CUR_MONTH AND XZ.ORG_CODE=SJFS.ORG_CODE AND XZ.TARGET=SJFS.TARGET 
                 ) R
         GROUP BY R.TARGET, R.CUR_YEAR, R.CUR_MONTH) R
 WHERE R.CUR_YEAR = ${if(year =='',"TO_CHAR(SYSDATE, 'yyyy')","'"+year+"'")}
   AND R.TARGET = '${target}'
) THIS_YEAR
--ORDER BY THIS_YEAR.FLAG, THIS_YEAR.CUR_MONTH
LEFT JOIN
(
SELECT R.*, SUM(R.MONEY) OVER(PARTITION BY R.TARGET ORDER BY MONTHS ROWS BETWEEN 12 PRECEDING AND 0 FOLLOWING) AS MONEY_LJ
  FROM (SELECT R.CUR_YEAR,
               R. CUR_MONTH || '月' AS CUR_MONTH,
               TO_NUMBER(R.CUR_MONTH) AS MONTHS,
               TARGET,
               DECODE(R.TARGET,
                      '合同额',
                      '1',
                      '立项利润',
                      '2',
                      '收款',
                      '3',
                      '结算收入',
                      '4',
                      '结算利润',
                      '5',
                      '6') AS FLAG,
               SUM(R.MONEY) AS MONEY
          FROM (SELECT SJFS.ORG_CODE,
SJFS.CUR_YEAR,
SJFS.CUR_MONTH,
SJFS.TARGET,
NVL(SJFS.MONEY,0)+NVL(XZ.XZ,0) AS MONEY
FROM  (SELECT * FROM (SELECT D.ORG_CODE,
                       D.CUR_YEAR,
                       D. CUR_MONTH,
                       '合同额' AS TARGET,
                       NVL2(SUM(D.CONTRACT_MONEY),
                            SUM(D.CONTRACT_MONEY) / 10000,
                            0) AS MONEY --合同额
                  FROM (SELECT P.CONFIRMED_DATE,
                               P.CONTRACT_SIGN_MONEY AS CONTRACT_MONEY,
                               P.CONTRACTOR_OFFICE AS ORG_CODE,
                  TO_CHAR(NVL(EXAM_DATE, SYSDATE), 'yyyy') AS CUR_YEAR,
                  TO_CHAR(NVL(EXAM_DATE, SYSDATE), 'mm') AS CUR_MONTH
                          FROM PRM_CONTRACT P
                         WHERE NVL(P.PROJECT_SOURCE_TYPE, 0) <> '4'
            AND P.PRM_CODE_TYPE<>'JI_GAI'
            AND TO_CHAR(P.CREATE_TIME,'yyyy')<=${year} - 1) D
                --WHERE D.CUR_YEAR >= TO_CHAR(SYSDATE, 'yyyy')
                 GROUP BY D.ORG_CODE, D.CUR_YEAR, D. CUR_MONTH
                UNION ALL --立项利润
                SELECT D.ORG_CODE,
                       D.CUR_YEAR,
                       D. CUR_MONTH,
                       '立项利润' AS TARGET,
                       NVL2(SUM(D.PROFIT_MONEY),
                            SUM(D.PROFIT_MONEY) / 10000,
                            0) AS MONEY --立项利润
                  FROM (SELECT R.ORG_CODE,
       R.PRM_PROJECT_MAIN_ID,
       R.CUR_YEAR,
       R.CUR_MONTH,
       R.PROFIT,
       R.PROFIT_L,
       (NVL(R.PROFIT, 0) - NVL(R.PROFIT_L, 0)) AS PROFIT_MONEY
  FROM (SELECT R.UUID,
               R.ORG_CODE,
               R.PRM_PROJECT_MAIN_ID,
               R.CUR_YEAR,
               R.CUR_MONTH,
               PROFIT,
               LEAD(R.PROFIT) OVER(PARTITION BY R.PRM_PROJECT_MAIN_ID ORDER BY R.CUR_YEAR DESC, R.CUR_MONTH DESC) AS PROFIT_L
          FROM (SELECT R.*,
                       ROW_NUMBER() OVER(PARTITION BY R.PRM_PROJECT_MAIN_ID, R.CUR_YEAR, R.CUR_MONTH ORDER BY R.CUR_TIME DESC) ROW_NUM
                  FROM (SELECT PPMC.UUID,
                               PPMC.CONTRACTOR_OFFICE AS ORG_CODE,
                               PPMC.PRM_PROJECT_MAIN_ID,
                               TO_CHAR(PPMC.EXAM_DATE,
                                       'yyyy') AS CUR_YEAR,
                               TO_CHAR(PPMC.EXAM_DATE,
                                       'mm') AS CUR_MONTH,
                               PPMC.EXAM_DATE AS CUR_TIME,
                               NVL(PPMC.PROJECT_MONEY, 0) -
                               NVL(PPMC.COST_CONTROL_MONEY, 0) AS PROFIT
                          FROM PRM_PROJECT_MAIN_C PPMC
                          WHERE  PPMC.STATE = 2
                           AND PPMC.PRM_CODE_TYPE<>'JI_GAI'
                           AND (SUBSTR(PPMC.PROJECT_CODE, 1, 1)<> '研' OR SUBSTR(PPMC.PROJECT_CODE, 7, 2) = 'KY' )--不含外部研发
                           AND NVL(PPMC.IS_PRE_PROJECT, 0) = 0
                           AND PPMC.ESTABLISH_DATE >=
                               TO_DATE('2014-06-01', 'yyyy-MM-dd')) R) R
         WHERE R.ROW_NUM = 1) R
) D
                --WHERE D.CUR_YEAR >= TO_CHAR(SYSDATE, 'yyyy')
                 GROUP BY D.ORG_CODE, D.CUR_YEAR, D. CUR_MONTH
                UNION ALL --收款
                SELECT R.ORG_CODE,
                       R.CUR_YEAR,
                       R.CUR_MONTH,
                       '收款' AS TARGET,
                       NVL2(SUM(R.ACTUAL_MONEY),
                            SUM(R.ACTUAL_MONEY) / 10000,
                            0) AS MONEY --收款
                  FROM (SELECT M.CONTRACTOR_OFFICE AS ORG_CODE,
                               T.ACTUAL_MONEY,
                               T.EXAM_DATE,
                               TO_CHAR(T.EXAM_DATE, 'yyyy') AS CUR_YEAR,
                               TO_CHAR(T.EXAM_DATE, 'mm') AS CUR_MONTH
                          FROM PRM_RECEIPTS T, PRM_PROJECT_MAIN M
                         WHERE T.PRM_PROJECT_MAIN_ID = M.UUID
                           AND T.STATE IN ('2', '4', '8')) R
                -- WHERE R.CUR_YEAR = TO_CHAR(SYSDATE, 'yyyy')
                 GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH
                UNION ALL
                --收入
                SELECT PPM.CONTRACTOR_OFFICE AS ORG_CODE,
                       JS.CUR_YEAR,
                       JS.CUR_MONTH,
                       '结算收入' AS TARGET,
                       SUM(JSSR) / 10000 AS MONEY
                  FROM (SELECT PROJECT_ID,
                               CUR_YEAR,
                               CUR_MONTH,
                               SUM(JSSR) AS JSSR
                          FROM (SELECT T.PRM_PROJECT_MAIN_ID AS PROJECT_ID,
                                       TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                                       TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                                       T.SQUARE_PROJECT_MONEY AS JSSR --收入
                                  FROM PRM_FINAL_ESTIMATE T
                                 WHERE T.EXAM_DATE IS NOT NULL) R
                         GROUP BY PROJECT_ID, CUR_YEAR, CUR_MONTH) JS
                  LEFT JOIN PRM_PROJECT_MAIN PPM ON PPM.UUID = JS.PROJECT_ID
                 GROUP BY PPM.CONTRACTOR_OFFICE, JS.CUR_YEAR, JS.CUR_MONTH
                
                UNION ALL
                --利润
                SELECT NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE) AS ORG_CODE,
               NVL(JS.CUR_YEAR,XZ.CUR_YEAR) AS CUR_YEAR,
               NVL(JS.CUR_MONTH,XZ.CUR_MONTH) AS CUR_MONTH,
                       '结算利润' AS TARGET,
                       SUM(NVL(JSLR, 0) - NVL(SJXZ, 0)) / 10000 AS JSLR
                  FROM (SELECT DEPARTMENT_CODE,
                               CUR_YEAR,
                               CUR_MONTH,
                               SUM(JSLR) AS JSLR
                          FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                       TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                                       TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                                       NVL(T. SQUARE_GROSS_PROFIT, 0)+
                                       NVL(T.TAX_CORRECTION, 0)  AS JSLR --利润
                                  FROM PRM_FINAL_ESTIMATE T
                                 WHERE T.EXAM_DATE IS NOT NULL) R
                         GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) JS
                  FULL JOIN (SELECT DEPARTMENT_CODE,
                                    CUR_YEAR,
                                    CUR_MONTH,
                                    SUM(SJXZ) AS SJXZ
                               FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                            TO_CHAR(T.EXAM_R_TAX_DATE, 'YYYY') AS CUR_YEAR,
                                            TO_CHAR(T.EXAM_R_TAX_DATE, 'MM') AS CUR_MONTH,
                                            T.TAX_CORRECTION AS SJXZ --税金修正
                                       FROM PRM_FINAL_ESTIMATE T
                                      WHERE T.EXAM_R_TAX_DATE IS NOT NULL) R
                              GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) XZ ON JS.
                 DEPARTMENT_CODE =
                                                                              XZ.DEPARTMENT_CODE
                                                                          AND JS.
                 CUR_YEAR =
                                                                              XZ.CUR_YEAR
                                                                          AND JS.
                 CUR_MONTH =
                                                                              XZ.CUR_MONTH
                  GROUP BY NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE), NVL(JS.CUR_YEAR,XZ.CUR_YEAR), NVL(JS.CUR_MONTH,XZ.CUR_MONTH)
                UNION ALL
                --收支盈余
                 SELECT R.ORG_CODE,
               TO_CHAR(R.CUR_YEAR) AS CUR_YEAR,
               TO_CHAR(R.CUR_MONTH) ASCUR_MONTH,
               '收支盈余'AS TARGET,
               SUM(MONEY) AS MONEY
          FROM (
                --人工费
               SELECT NVL(QTCB.ORG_CODE, JSLR.ORG_CODE) AS ORG_CODE,
       NVL(QTCB.CUR_YEAR, JSLR.CUR_YEAR) AS CUR_YEAR,
       NVL(QTCB.CUR_MONTH, JSLR.CUR_MONTH) AS CUR_MONTH,
       '收支盈余',
       NVL(JSLR.JSLR, 0) - NVL(QTCB.MONEY, 0) AS MONEY
  FROM (SELECT R.ORG_CODE,
               TO_CHAR(R.CUR_YEAR) AS CUR_YEAR,
               (CASE WHEN R.CUR_MONTH>=10 THEN TO_CHAR(R.CUR_MONTH) ELSE '0'||TO_CHAR(R.CUR_MONTH) END) AS CUR_MONTH,
               '其他成本',
               SUM(MONEY) AS MONEY
          FROM (
                --人工费
                SELECT MLC.OFFICE_ID AS ORG_CODE,
                        MLC.YEAR AS CUR_YEAR,
                        MLC.MONTH AS CUR_MONTH,
                        SUM(MONEY) / 10000 AS MONEY
                  FROM MONITOR_LABOR_COST MLC
                 GROUP BY OFFICE_ID, MLC.YEAR, MLC.MONTH
                UNION ALL
                --其他分摊费用
                SELECT MOS.OFFICE_ID AS ORG_CODE,
                       MOS.YEAR AS CUR_YEAR,
                       MOS.MONTH AS CUR_MONTH,
                       SUM(MONEY) / 10000 AS MONEY
                  FROM MONITOR_OTHER_SHARE MOS
                 GROUP BY OFFICE_ID, MOS.YEAR, MOS.MONTH
                UNION ALL
                --非项目费用
                SELECT ORG_CODE,
                       TO_NUMBER(CUR_YEAR) AS CUR_YEAR,
                       TO_NUMBER(CUR_MONTH) AS CUR_MONTH,
                       SUM(MONEY) / 10000 AS MONEY
                  FROM (SELECT NPBH.OFFICE_ID AS ORG_CODE,
                               TO_CHAR(VBD48.CERTIFICATE_CREATE_TIME, 'yyyy') AS CUR_YEAR,
                               TO_CHAR(VBD48.CERTIFICATE_CREATE_TIME, 'mm') AS CUR_MONTH,
                               VBD48.MONEY
                          FROM (SELECT NVL(NVL(FAD_CASH_REQ_INVOICE.FAD_INVOICE_ID,
                                               SCM_CONTRACT_INVOICE.FAD_INVOICE_ID),
                                           VBD48.UUID) UUID,
                                       VBD48.CERTIFICATE_CREATE_TIME,
                                       VBD48.BUDGET_C_UUID,
                                       VBD48.SUBJECT_NAME,
                                       NVL(VBD48.MONEY, 0) MONEY
                                  FROM VW_BUDGET_DETAIL49 VBD48
                                  LEFT JOIN FAD_CASH_REQ_INVOICE ON VBD48.UUID =
                                                                    FAD_CASH_REQ_INVOICE.UUID
                                  LEFT JOIN SCM_CONTRACT_INVOICE ON VBD48.UUID =
                                                                    SCM_CONTRACT_INVOICE.UUID
                                 WHERE NVL(VBD48.IS_PROJECT, 0) != 1
                                   AND VBD48.BUDGET_C_UUID IS NOT NULL) VBD48
                          LEFT JOIN NON_PROJECT_BUDGET_C NPBC ON VBD48.BUDGET_C_UUID =
                                                                 NPBC.UUID
                          LEFT JOIN NON_PROJECT_BUDGET_H NPBH ON NPBC.HID =
                                                                 NPBH.UUID) R
                 GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH) R
         GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH) QTCB
--结算利润
  FULL JOIN (SELECT  NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE) AS ORG_CODE,
             NVL(JS.CUR_YEAR,XZ.CUR_YEAR) AS CUR_YEAR,
             NVL(JS.CUR_MONTH,XZ.CUR_MONTH) AS CUR_MONTH,
                    '结算利润' AS TARGET,
                    SUM(NVL(JSLR, 0) - NVL(SJXZ, 0)) / 10000 AS JSLR
               FROM (SELECT DEPARTMENT_CODE,
                            CUR_YEAR,
                            CUR_MONTH,
                            SUM(JSLR) AS JSLR
                       FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                    TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                                    TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                                    NVL(T. SQUARE_GROSS_PROFIT, 0)+
                                       NVL(T.TAX_CORRECTION, 0) AS JSLR --利润
                               FROM PRM_FINAL_ESTIMATE T
                              WHERE T.EXAM_DATE IS NOT NULL) R
                      GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) JS
               FULL JOIN (SELECT DEPARTMENT_CODE,
                                CUR_YEAR,
                                CUR_MONTH,
                                SUM(SJXZ) AS SJXZ
                           FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                        TO_CHAR(T.EXAM_R_TAX_DATE, 'YYYY') AS CUR_YEAR,
                                        TO_CHAR(T.EXAM_R_TAX_DATE, 'MM') AS CUR_MONTH,
                                        T.TAX_CORRECTION AS SJXZ --税金修正
                                   FROM PRM_FINAL_ESTIMATE T
                                  WHERE T.EXAM_R_TAX_DATE IS NOT NULL) R
                          GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) XZ ON JS.
              DEPARTMENT_CODE =
                                                                          XZ.DEPARTMENT_CODE
                                                                      AND JS.
              CUR_YEAR =
                                                                          XZ.CUR_YEAR
                                                                      AND JS.
              CUR_MONTH =
                                                                          XZ.CUR_MONTH
               GROUP BY NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE), NVL(JS.CUR_YEAR,XZ.CUR_YEAR), NVL(JS.CUR_MONTH,XZ.CUR_MONTH)) JSLR ON JSLR.ORG_CODE =
                                                                                 QTCB.ORG_CODE
                                                                             AND JSLR.CUR_YEAR =
                                                                                 QTCB.CUR_YEAR
                                                                             AND JSLR.CUR_MONTH =
                                                                                 QTCB.CUR_MONTH
) R
         GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH)T WHERE EXISTS (SELECT 1 FROM OPERATE_COMPANY_PLAN_H H
                        LEFT JOIN
                        OPERATE_COMPANY_PLAN_C C
                        ON H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
                        WHERE H.START_YEAR=T.CUR_YEAR
                                AND C.OBJECT_ID = T.ORG_CODE) ) SJFS--实际发生
         LEFT JOIN (SELECT H.START_YEAR AS CUR_YEAR,1 AS CUR_MONTH ,C.OBJECT_ID AS ORG_CODE,'立项利润' AS TARGET, NVL(C.LXLRXZ, 0) AS XZ
  FROM OPERATE_COMPANY_PLAN_H H
  LEFT JOIN OPERATE_COMPANY_PLAN_C C ON H.UUID =
                                        C.OPERATE_COMPANY_PLAN_H_ID
                                        UNION ALL
SELECT H.START_YEAR AS CUR_YEAR,1 AS CUR_MONTH ,C.OBJECT_ID AS ORG_CODE,'合同额' AS TARGET, NVL(C.HTEXZ, 0) AS XZ
  FROM OPERATE_COMPANY_PLAN_H H
  LEFT JOIN OPERATE_COMPANY_PLAN_C C ON H.UUID =
                                        C.OPERATE_COMPANY_PLAN_H_ID
                                        )XZ --修正值
ON XZ.CUR_YEAR=SJFS.CUR_YEAR AND  XZ.CUR_MONTH=SJFS.CUR_MONTH AND XZ.ORG_CODE=SJFS.ORG_CODE AND XZ.TARGET=SJFS.TARGET 
                 ) R
         GROUP BY R.TARGET, R.CUR_YEAR, R.CUR_MONTH) R
 WHERE R.CUR_YEAR = ${if(year =='',"TO_CHAR(SYSDATE, 'yyyy')","'"+year+"'")} - 1
   AND R.TARGET = '${target}'
) LAST_YEAR
--ORDER BY LAST_YEAR.FLAG, LAST_YEAR.CUR_MONTH
ON
THIS_YEAR.MONTHS  = LAST_YEAR.MONTHS
AND
THIS_YEAR.FLAG = LAST_YEAR.FLAG
) ALL_YEAR
ORDER BY ALL_YEAR.FLAG, ALL_YEAR.CUR_MONTH,ALL_YEAR.CUR_YEAR DESC]]></Query>
</TableData>
<TableData name="T2_TOTAL" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="year"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="target"/>
<O>
<![CDATA[合同额]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[ERP]]></DatabaseName>
</Connection>
<Query>
<![CDATA[--T2_TOTAL
SELECT NVL(JH.CUR_YEAR, R.CUR_YEAR) AS CUR_YEAR,
       NVL(JH.TARGET, R.TARGET) AS TARGET,
       NVL(JH.MONEY_JH, 0) MONEY_JH,
       NVL(R.MONEY, 0)+NVL(XZ, 0) AS MONEY
  FROM (SELECT R.CUR_YEAR, R.TARGET, SUM(MONEY) AS MONEY
          FROM (SELECT D.ORG_CODE,
                       D.CUR_YEAR,
                       '合同额' AS TARGET,
                       NVL2(SUM(D.CONTRACT_MONEY),
                            SUM(D.CONTRACT_MONEY) / 10000,
                            0) AS MONEY --合同额
                  FROM (SELECT P.EXAM_DATE,
                               P.CONTRACT_SIGN_MONEY AS CONTRACT_MONEY,
                               P.CONTRACTOR_OFFICE AS ORG_CODE,
                  TO_CHAR(NVL(EXAM_DATE, SYSDATE), 'yyyy') AS CUR_YEAR,
                  TO_CHAR(NVL(EXAM_DATE, SYSDATE), 'mm') AS CUR_MONTH
                          FROM PRM_CONTRACT P
                         WHERE NVL(P.PROJECT_SOURCE_TYPE, 0) <> '4'
            AND P.PRM_CODE_TYPE<>'JI_GAI'
            AND TO_CHAR(P.CREATE_TIME,'yyyy')<=${year}) D
                 GROUP BY D.ORG_CODE, D.CUR_YEAR
                UNION ALL --立项利润
                SELECT D.ORG_CODE,
                       D.CUR_YEAR,
                       '立项利润' AS TARGET,
                       NVL2(SUM(D.PROFIT_MONEY),
                            SUM(D.PROFIT_MONEY) / 10000,
                            0) AS MONEY --立项利润
                  FROM (SELECT R.ORG_CODE,
       R.PRM_PROJECT_MAIN_ID,
       R.CUR_YEAR,
       R.CUR_MONTH,
       R.PROFIT,
       R.PROFIT_L,
       (NVL(R.PROFIT, 0) - NVL(R.PROFIT_L, 0)) AS PROFIT_MONEY
  FROM (SELECT R.UUID,
               R.ORG_CODE,
               R.PRM_PROJECT_MAIN_ID,
               R.CUR_YEAR,
               R.CUR_MONTH,
               PROFIT,
               LEAD(R.PROFIT) OVER(PARTITION BY R.PRM_PROJECT_MAIN_ID ORDER BY R.CUR_YEAR DESC, R.CUR_MONTH DESC) AS PROFIT_L
          FROM (SELECT R.*,
                       ROW_NUMBER() OVER(PARTITION BY R.PRM_PROJECT_MAIN_ID, R.CUR_YEAR, R.CUR_MONTH ORDER BY R.CUR_TIME DESC) ROW_NUM
                  FROM (SELECT PPMC.UUID,
                               PPMC.CONTRACTOR_OFFICE AS ORG_CODE,
                               PPMC.PRM_PROJECT_MAIN_ID,
                               TO_CHAR(PPMC.EXAM_DATE,
                                       'yyyy') AS CUR_YEAR,
                               TO_CHAR(PPMC.EXAM_DATE,
                                       'mm') AS CUR_MONTH,
                               PPMC.EXAM_DATE AS CUR_TIME,
                               NVL(PPMC.PROJECT_MONEY, 0) -
                               NVL(PPMC.COST_CONTROL_MONEY, 0) AS PROFIT
                          FROM PRM_PROJECT_MAIN_C PPMC
                          WHERE  PPMC.STATE = 2
                           AND PPMC.PRM_CODE_TYPE<>'JI_GAI'
                           AND (SUBSTR(PPMC.PROJECT_CODE, 1, 1)<> '研' OR SUBSTR(PPMC.PROJECT_CODE, 7, 2) = 'KY' )--不含外部研发
                           AND NVL(PPMC.IS_PRE_PROJECT, 0) = 0
                           AND PPMC.ESTABLISH_DATE >=
                               TO_DATE('2014-06-01', 'yyyy-MM-dd')) R) R
         WHERE R.ROW_NUM = 1) R) D
                 GROUP BY D.ORG_CODE, D.CUR_YEAR
                UNION ALL --收款
                SELECT R.ORG_CODE,
                       R.CUR_YEAR,
                       '收款' AS TARGET,
                       NVL2(SUM(R.ACTUAL_MONEY),
                            SUM(R.ACTUAL_MONEY) / 10000,
                            0) AS MONEY --收款
                  FROM (SELECT M.CONTRACTOR_OFFICE AS ORG_CODE,
                               T.ACTUAL_MONEY,
                               T.EXAM_DATE,
                               TO_CHAR(T.EXAM_DATE, 'yyyy') AS CUR_YEAR,
                               TO_CHAR(T.EXAM_DATE, 'mm') AS CUR_MONTH
                          FROM PRM_RECEIPTS T, PRM_PROJECT_MAIN M
                         WHERE T.PRM_PROJECT_MAIN_ID = M.UUID
                           AND T.STATE IN ('2', '4', '8')) R
                 GROUP BY R.ORG_CODE, R.CUR_YEAR
                UNION ALL
                --收入
                SELECT PPM.CONTRACTOR_OFFICE AS ORG_CODE,
                       JS.CUR_YEAR,
                       '结算收入' AS TARGET,
                       SUM(JSSR) / 10000 AS MONEY
                  FROM (SELECT PROJECT_ID,
                               CUR_YEAR,
                               CUR_MONTH,
                               SUM(JSSR) AS JSSR
                          FROM (SELECT T.PRM_PROJECT_MAIN_ID AS PROJECT_ID,
                                       TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                                       TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                                       T.SQUARE_PROJECT_MONEY AS JSSR --收入
                                  FROM PRM_FINAL_ESTIMATE T
                                 WHERE T.EXAM_DATE IS NOT NULL) R
                         GROUP BY PROJECT_ID, CUR_YEAR, CUR_MONTH) JS
                  LEFT JOIN PRM_PROJECT_MAIN PPM ON PPM.UUID = JS.PROJECT_ID
                 GROUP BY PPM.CONTRACTOR_OFFICE, JS.CUR_YEAR
                
                UNION ALL
                --利润
                SELECT NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE) AS ORG_CODE,
               NVL(JS.CUR_YEAR,XZ.CUR_YEAR) AS CUR_YEAR,
                       '结算利润' AS TARGET,
                       SUM(NVL(JSLR, 0) - NVL(SJXZ, 0)) / 10000 AS JSLR
                  FROM (SELECT DEPARTMENT_CODE,
                               CUR_YEAR,
                               CUR_MONTH,
                               SUM(JSLR) AS JSLR
                          FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                       TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                                       TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                                       NVL(T. SQUARE_GROSS_PROFIT, 0)+
                                       NVL(T.TAX_CORRECTION, 0) AS JSLR --利润
                                  FROM PRM_FINAL_ESTIMATE T
                                 WHERE T.EXAM_DATE IS NOT NULL) R
                         GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) JS
                  FULL JOIN (SELECT DEPARTMENT_CODE,
                                    CUR_YEAR,
                                    CUR_MONTH,
                                    SUM(SJXZ) AS SJXZ
                               FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                            TO_CHAR(T.EXAM_R_TAX_DATE, 'YYYY') AS CUR_YEAR,
                                            TO_CHAR(T.EXAM_R_TAX_DATE, 'MM') AS CUR_MONTH,
                                            T.TAX_CORRECTION AS SJXZ --税金修正
                                       FROM PRM_FINAL_ESTIMATE T
                                      WHERE T.EXAM_R_TAX_DATE IS NOT NULL) R
                              GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) XZ ON JS.
                 DEPARTMENT_CODE =
                                                                              XZ.DEPARTMENT_CODE
                                                                          AND JS.
                 CUR_YEAR =
                                                                              XZ.CUR_YEAR
                                                                          AND JS.
                 CUR_MONTH =
                                                                              XZ.CUR_MONTH
                 GROUP BY NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE), NVL(JS.CUR_YEAR,XZ.CUR_YEAR)
                 UNION ALL
        --收支盈余
        SELECT R.ORG_CODE,
               TO_CHAR(R.CUR_YEAR),
               '收支盈余',
               SUM(MONEY) AS MONEY
          FROM (
               SELECT NVL(QTCB.ORG_CODE, JSLR.ORG_CODE) AS ORG_CODE,
       NVL(QTCB.CUR_YEAR, JSLR.CUR_YEAR) AS CUR_YEAR,
       NVL(QTCB.CUR_MONTH, JSLR.CUR_MONTH) AS CUR_MONTH,
       '收支盈余',
       NVL(JSLR.JSLR, 0) - NVL(QTCB.MONEY, 0) AS MONEY
  FROM (SELECT R.ORG_CODE,
               TO_CHAR(R.CUR_YEAR) AS CUR_YEAR,
               (CASE WHEN R.CUR_MONTH>=10 THEN TO_CHAR(R.CUR_MONTH) ELSE '0'||TO_CHAR(R.CUR_MONTH) END) AS CUR_MONTH,
               '其他成本',
               SUM(MONEY) AS MONEY
          FROM (
                --人工费
                SELECT MLC.OFFICE_ID AS ORG_CODE,
                        MLC.YEAR AS CUR_YEAR,
                        MLC.MONTH AS CUR_MONTH,
                        SUM(MONEY) / 10000 AS MONEY
                  FROM MONITOR_LABOR_COST MLC
                 GROUP BY OFFICE_ID, MLC.YEAR, MLC.MONTH
                UNION ALL
                --其他分摊费用
                SELECT MOS.OFFICE_ID AS ORG_CODE,
                       MOS.YEAR AS CUR_YEAR,
                       MOS.MONTH AS CUR_MONTH,
                       SUM(MONEY) / 10000 AS MONEY
                  FROM MONITOR_OTHER_SHARE MOS
                 GROUP BY OFFICE_ID, MOS.YEAR, MOS.MONTH
                UNION ALL
                --非项目费用
                SELECT ORG_CODE,
                       TO_NUMBER(CUR_YEAR) AS CUR_YEAR,
                       TO_NUMBER(CUR_MONTH) AS CUR_MONTH,
                       SUM(MONEY) / 10000 AS MONEY
                  FROM (SELECT NPBH.OFFICE_ID AS ORG_CODE,
                               TO_CHAR(VBD48.CERTIFICATE_CREATE_TIME, 'yyyy') AS CUR_YEAR,
                               TO_CHAR(VBD48.CERTIFICATE_CREATE_TIME, 'mm') AS CUR_MONTH,
                               VBD48.MONEY
                          FROM (SELECT NVL(NVL(FAD_CASH_REQ_INVOICE.FAD_INVOICE_ID,
                                               SCM_CONTRACT_INVOICE.FAD_INVOICE_ID),
                                           VBD48.UUID) UUID,
                                       VBD48.CERTIFICATE_CREATE_TIME,
                                       VBD48.BUDGET_C_UUID,
                                       VBD48.SUBJECT_NAME,
                                       NVL(VBD48.MONEY, 0) MONEY
                                  FROM VW_BUDGET_DETAIL49 VBD48
                                  LEFT JOIN FAD_CASH_REQ_INVOICE ON VBD48.UUID =
                                                                    FAD_CASH_REQ_INVOICE.UUID
                                  LEFT JOIN SCM_CONTRACT_INVOICE ON VBD48.UUID =
                                                                    SCM_CONTRACT_INVOICE.UUID
                                 WHERE NVL(VBD48.IS_PROJECT, 0) != 1
                                   AND VBD48.BUDGET_C_UUID IS NOT NULL) VBD48
                          LEFT JOIN NON_PROJECT_BUDGET_C NPBC ON VBD48.BUDGET_C_UUID =
                                                                 NPBC.UUID
                          LEFT JOIN NON_PROJECT_BUDGET_H NPBH ON NPBC.HID =
                                                                 NPBH.UUID) R
                 GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH) R
         WHERE EXISTS (SELECT 1
                  FROM OPERATE_COMPANY_PLAN_H H
                  LEFT JOIN OPERATE_COMPANY_PLAN_C C ON H.UUID =
                                                        C.OPERATE_COMPANY_PLAN_H_ID
                 WHERE H.START_YEAR = R.CUR_YEAR
                   AND C.OBJECT_ID = R.ORG_CODE)
         GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH) QTCB
--结算利润
  FULL JOIN (SELECT NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE) AS ORG_CODE,
           NVL(JS.CUR_YEAR,XZ.CUR_YEAR) AS CUR_YEAR,
           NVL(JS.CUR_MONTH,XZ.CUR_MONTH) AS CUR_MONTH,
           '结算利润' AS TARGET,
                    SUM(NVL(JSLR, 0) - NVL(SJXZ, 0)) / 10000 AS JSLR
               FROM (SELECT DEPARTMENT_CODE,
                            CUR_YEAR,
                            CUR_MONTH,
                            SUM(JSLR) AS JSLR
                       FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                    TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                                    TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                                    NVL(T. SQUARE_GROSS_PROFIT, 0)+
                                       NVL(T.TAX_CORRECTION, 0)  AS JSLR --利润
                               FROM PRM_FINAL_ESTIMATE T
                              WHERE T.EXAM_DATE IS NOT NULL) R
                      GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) JS
               FULL JOIN (SELECT DEPARTMENT_CODE,
                                CUR_YEAR,
                                CUR_MONTH,
                                SUM(SJXZ) AS SJXZ
                           FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                        TO_CHAR(T.EXAM_R_TAX_DATE, 'YYYY') AS CUR_YEAR,
                                        TO_CHAR(T.EXAM_R_TAX_DATE, 'MM') AS CUR_MONTH,
                                        T.TAX_CORRECTION AS SJXZ --税金修正
                                   FROM PRM_FINAL_ESTIMATE T
                                  WHERE T.EXAM_R_TAX_DATE IS NOT NULL) R
                          GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) XZ ON JS.
              DEPARTMENT_CODE =
                                                                          XZ.DEPARTMENT_CODE
                                                                      AND JS.
              CUR_YEAR =
                                                                          XZ.CUR_YEAR
                                                                      AND JS.
              CUR_MONTH =
                                                                          XZ.CUR_MONTH
               GROUP BY  NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE), NVL(JS.CUR_YEAR,XZ.CUR_YEAR), NVL(JS.CUR_MONTH,XZ.CUR_MONTH)) JSLR ON JSLR.ORG_CODE =
                                                                                 QTCB.ORG_CODE
                                                                             AND JSLR.CUR_YEAR =
                                                                                 QTCB.CUR_YEAR
                                                                             AND JSLR.CUR_MONTH =
                                                                                 QTCB.CUR_MONTH
) R
         GROUP BY R.ORG_CODE, R.CUR_YEAR) R
                          WHERE EXISTS (SELECT 1 FROM OPERATE_COMPANY_PLAN_H H
                        LEFT JOIN
                        OPERATE_COMPANY_PLAN_C C
                        ON H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
                        WHERE H.START_YEAR=R.CUR_YEAR
                                AND C.OBJECT_ID = R.ORG_CODE)
         GROUP BY R.CUR_YEAR, R.TARGET
         ) R
  FULL JOIN ( --指标
             SELECT JH.CUR_YEAR, JH.TARGET, SUM(MONEY_JH) AS MONEY_JH,SUM(XZ) AS XZ
               FROM (SELECT H.START_YEAR AS CUR_YEAR,
                             '合同额' AS TARGET,
                             JHHTE AS MONEY_JH, --合同额（万元）
                             (SELECT SUM(C.HTEXZ) FROM OPERATE_COMPANY_PLAN_C C WHERE C.OPERATE_COMPANY_PLAN_H_ID= H.UUID) AS XZ
                        FROM OPERATE_COMPANY_PLAN_H H
                      -- AND H.START_YEAR = TO_CHAR(SYSDATE, 'yyyy')
                      UNION ALL
                      --立项利润
                      SELECT H.START_YEAR AS CUR_YEAR,
                             '立项利润' AS TARGET,
                             JHLXLR,
                             (SELECT SUM(C.LXLRXZ) FROM OPERATE_COMPANY_PLAN_C C WHERE C.OPERATE_COMPANY_PLAN_H_ID= H.UUID) AS XZ
                        FROM OPERATE_COMPANY_PLAN_H H
                      --AND H.START_YEAR = TO_CHAR(SYSDATE, 'yyyy')
                      UNION ALL
                      --收款
                      SELECT H.START_YEAR AS CUR_YEAR, 
                              '收款' AS TARGET, JHSR,
                              0 AS XZ
                        FROM OPERATE_COMPANY_PLAN_H H
                      UNION ALL
                      --结算收入
                      SELECT H.START_YEAR AS CUR_YEAR,
                             '结算收入' AS TARGET,
                             JHJSSR,
                             0 AS XZ
                        FROM OPERATE_COMPANY_PLAN_H H
                      UNION ALL
                      --结算利润
                      SELECT H.START_YEAR AS CUR_YEAR,
                             '结算利润' AS TARGET,
                             JHJSLR,
                             0 AS XZ
                        FROM OPERATE_COMPANY_PLAN_H H
                         UNION ALL
                       --收支盈余
                      SELECT H.START_YEAR AS CUR_YEAR,
                             '收支盈余' AS TARGET,
                             SUM(NVL(C.JHSZYY,0)) AS JHSZYY,
                             0 AS XZ
                        FROM OPERATE_COMPANY_PLAN_H H
                        LEFT JOIN
                        OPERATE_COMPANY_PLAN_C C
                        ON H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
                        GROUP BY H.START_YEAR
                      ) JH
              GROUP BY JH.CUR_YEAR, JH.TARGET) JH ON R.CUR_YEAR =
                                                     JH.CUR_YEAR
                                                 AND R.TARGET = JH.TARGET
 WHERE JH.CUR_YEAR = ${if(year =='',"TO_CHAR(SYSDATE, 'yyyy')","'"+year+"'")}
   AND JH.TARGET = '${target}']]></Query>
</TableData>
<TableData name="REMARK" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="year"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[ERP]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT H.REMARK
  FROM OPERATE_COMPANY_PLAN_H H
 WHERE H.START_YEAR = ${year}]]></Query>
</TableData>
<TableData name="year" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[ERP]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT H.START_YEAR AS SYS_CODE, H.START_YEAR || '年' AS CODE_DESC
  FROM OPERATE_COMPANY_PLAN_H H
 ORDER BY H.START_YEAR DESC]]></Query>
</TableData>
<TableData name="T4" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="year"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="target"/>
<O>
<![CDATA[合同额]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[ERP]]></DatabaseName>
</Connection>
<Query>
<![CDATA[--T4
SELECT NVL(R.ORG_CODE, JH.ORG_CODE) AS ORG_CODE,
       SO.SHORT_CODE AS ORG_NAME,
       NVL(R.CUR_YEAR, JH.CUR_YEAR) AS CUR_YEAR,
       NVL(R.TARGET, JH.TARGET) AS TARGET,
       NVL(R.MONEY, 0) + NVL(JH.JZ, 0) AS MONEY,
       NVL(JH.JZ, 0) AS JZ,
       NVL(JH.MONEY_JH, 0) AS MONEY_JH,
       DECODE(NVL(JH.MONEY_JH, 0),
              0,
              0,
              (NVL(R.MONEY, 0) + NVL(JH.JZ, 0)) / JH.MONEY_JH) AS WCBL
  FROM (SELECT D.ORG_CODE,
               D.CUR_YEAR,
               '合同额' AS TARGET,
               NVL2(SUM(D.CONTRACT_MONEY), SUM(D.CONTRACT_MONEY) / 10000, 0) AS MONEY --合同额
          FROM (SELECT P.EXAM_DATE,
                       P.CONTRACT_SIGN_MONEY AS CONTRACT_MONEY,
                       P.CONTRACTOR_OFFICE AS ORG_CODE,
                       TO_CHAR(NVL(EXAM_DATE, SYSDATE), 'yyyy') AS CUR_YEAR,
                       TO_CHAR(NVL(EXAM_DATE, SYSDATE), 'mm') AS CUR_MONTH
                  FROM PRM_CONTRACT P
                 WHERE NVL(P.PROJECT_SOURCE_TYPE, 0) <> '4'
				AND P.PRM_CODE_TYPE<>'JI_GAI'
				AND TO_CHAR(P.CREATE_TIME,'yyyy')<=${year}) D
         GROUP BY D.ORG_CODE, D.CUR_YEAR
        UNION ALL --立项利润
        SELECT D.ORG_CODE,
               D.CUR_YEAR,
               '立项利润' AS TARGET,
               NVL2(SUM(D.PROFIT_MONEY), SUM(D.PROFIT_MONEY) / 10000, 0) AS MONEY --立项利润
          FROM (SELECT R.ORG_CODE,
       R.PRM_PROJECT_MAIN_ID,
       R.CUR_YEAR,
       R.CUR_MONTH,
       R.PROFIT,
       R.PROFIT_L,
       (NVL(R.PROFIT, 0) - NVL(R.PROFIT_L, 0)) AS PROFIT_MONEY
  FROM (SELECT R.UUID,
               R.ORG_CODE,
               R.PRM_PROJECT_MAIN_ID,
               R.CUR_YEAR,
               R.CUR_MONTH,
               PROFIT,
               LEAD(R.PROFIT) OVER(PARTITION BY R.PRM_PROJECT_MAIN_ID ORDER BY R.CUR_YEAR DESC, R.CUR_MONTH DESC) AS PROFIT_L
          FROM (SELECT R.*,
                       ROW_NUMBER() OVER(PARTITION BY R.PRM_PROJECT_MAIN_ID, R.CUR_YEAR, R.CUR_MONTH ORDER BY R.CUR_TIME DESC) ROW_NUM
                  FROM (SELECT PPMC.UUID,
                               PPMC.CONTRACTOR_OFFICE AS ORG_CODE,
                               PPMC.PRM_PROJECT_MAIN_ID,
                               TO_CHAR(PPMC.EXAM_DATE,
                                       'yyyy') AS CUR_YEAR,
                               TO_CHAR(PPMC.EXAM_DATE,
                                       'mm') AS CUR_MONTH,
                               PPMC.EXAM_DATE AS CUR_TIME,
                               NVL(PPMC.PROJECT_MONEY, 0) -
                               NVL(PPMC.COST_CONTROL_MONEY, 0) AS PROFIT
                          FROM PRM_PROJECT_MAIN_C PPMC
                         WHERE  PPMC.STATE = 2
													 AND PPMC.PRM_CODE_TYPE<>'JI_GAI'
                           AND (SUBSTR(PPMC.PROJECT_CODE, 1, 1)<> '研' OR SUBSTR(PPMC.PROJECT_CODE, 7, 2) = 'KY' )--不含外部研发
                           AND NVL(PPMC.IS_PRE_PROJECT, 0) = 0
                           AND PPMC.ESTABLISH_DATE >=
                               TO_DATE('2014-06-01', 'yyyy-MM-dd')) R) R
         WHERE R.ROW_NUM = 1) R) D
         GROUP BY D.ORG_CODE, D.CUR_YEAR
        UNION ALL --收款
        SELECT R.ORG_CODE,
               R.CUR_YEAR,
               '收款' AS TARGET,
               NVL2(SUM(R.ACTUAL_MONEY), SUM(R.ACTUAL_MONEY) / 10000, 0) AS MONEY --收款
          FROM (SELECT M.CONTRACTOR_OFFICE AS ORG_CODE,
                       T.ACTUAL_MONEY,
                       T.EXAM_DATE,
                       TO_CHAR(T.EXAM_DATE, 'yyyy') AS CUR_YEAR,
                       TO_CHAR(T.EXAM_DATE, 'mm') AS CUR_MONTH
                  FROM PRM_RECEIPTS T, PRM_PROJECT_MAIN M
                 WHERE T.PRM_PROJECT_MAIN_ID = M.UUID
                   AND T.STATE IN ('2', '4', '8')) R
         GROUP BY R.ORG_CODE, R.CUR_YEAR
        UNION ALL
        --收入
        SELECT PPM.CONTRACTOR_OFFICE AS ORG_CODE,
               JS.CUR_YEAR,
               '结算收入' AS TARGET,
               SUM(JSSR) / 10000 AS MONEY
          FROM (SELECT PROJECT_ID, CUR_YEAR, CUR_MONTH, SUM(JSSR) AS JSSR
                  FROM (SELECT T.PRM_PROJECT_MAIN_ID AS PROJECT_ID,
                               TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                               TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                               T.SQUARE_PROJECT_MONEY AS JSSR --收入
                          FROM PRM_FINAL_ESTIMATE T
                         WHERE T.EXAM_DATE IS NOT NULL) R
                 GROUP BY PROJECT_ID, CUR_YEAR, CUR_MONTH) JS
          LEFT JOIN PRM_PROJECT_MAIN PPM ON PPM.UUID = JS.PROJECT_ID
          WHERE SUBSTR(PPM.PROJECT_CODE, 0, 1)<>'研'
         GROUP BY PPM.CONTRACTOR_OFFICE, JS.CUR_YEAR
        
        UNION ALL
        --利润
        SELECT NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE) AS ORG_CODE,
       		NVL(JS.CUR_YEAR,XZ.CUR_YEAR) AS CUR_YEAR,
               '结算利润' AS TARGET,
               SUM(NVL(JSLR, 0) - NVL(SJXZ, 0)) / 10000 AS JSLR
          FROM (SELECT DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH, SUM(JSLR) AS JSLR
                  FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                               TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                               TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                               NVL(T. SQUARE_GROSS_PROFIT, 0)+
                                       NVL(T.TAX_CORRECTION, 0)  AS JSLR --利润
                          FROM PRM_FINAL_ESTIMATE T
                         WHERE T.EXAM_DATE IS NOT NULL
                          AND NOT EXISTS
              (SELECT 1
                       FROM PRM_PROJECT_MAIN PPM
                      WHERE PPM.UUID = T.PRM_PROJECT_MAIN_ID
                        AND SUBSTR(PPM.PROJECT_CODE, 0, 1) = '研')) R
                 GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) JS
          FULL JOIN (SELECT DEPARTMENT_CODE,
                            CUR_YEAR,
                            CUR_MONTH,
                            SUM(SJXZ) AS SJXZ
                       FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                    TO_CHAR(T.EXAM_R_TAX_DATE, 'YYYY') AS CUR_YEAR,
                                    TO_CHAR(T.EXAM_R_TAX_DATE, 'MM') AS CUR_MONTH,
                                    T.TAX_CORRECTION AS SJXZ --税金修正
                               FROM PRM_FINAL_ESTIMATE T
                              WHERE T.EXAM_R_TAX_DATE IS NOT NULL
                               AND NOT EXISTS
              (SELECT 1
                       FROM PRM_PROJECT_MAIN PPM
                      WHERE PPM.UUID = T.PRM_PROJECT_MAIN_ID
                        AND SUBSTR(PPM.PROJECT_CODE, 0, 1) = '研')) R
                      GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) XZ ON JS.
         DEPARTMENT_CODE =
                                                                      XZ.DEPARTMENT_CODE
                                                                  AND JS.
         CUR_YEAR =
                                                                      XZ.CUR_YEAR
                                                                  AND JS.
         CUR_MONTH =
                                                                      XZ.CUR_MONTH
          GROUP BY NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE), NVL(JS.CUR_YEAR,XZ.CUR_YEAR)
        UNION ALL
        --收支盈余
        SELECT R.ORG_CODE,
               TO_CHAR(R.CUR_YEAR),
               '收支盈余',
               SUM(MONEY) AS MONEY
          FROM (
                --人工费
                SELECT NVL(QTCB.ORG_CODE, JSLR.ORG_CODE) AS ORG_CODE,
       NVL(QTCB.CUR_YEAR, JSLR.CUR_YEAR) AS CUR_YEAR,
       NVL(QTCB.CUR_MONTH, JSLR.CUR_MONTH) AS CUR_MONTH,
       '收支盈余',
       NVL(JSLR.JSLR, 0) - NVL(QTCB.MONEY, 0) AS MONEY
  FROM (SELECT R.ORG_CODE,
               TO_CHAR(R.CUR_YEAR) AS CUR_YEAR,
               (CASE WHEN R.CUR_MONTH>=10 THEN TO_CHAR(R.CUR_MONTH) ELSE '0'||TO_CHAR(R.CUR_MONTH) END) AS CUR_MONTH,
               '其他成本',
               SUM(MONEY) AS MONEY
          FROM (
                --人工费
                SELECT MLC.OFFICE_ID AS ORG_CODE,
                        MLC.YEAR AS CUR_YEAR,
                        MLC.MONTH AS CUR_MONTH,
                        SUM(MONEY) / 10000 AS MONEY
                  FROM MONITOR_LABOR_COST MLC
                 GROUP BY OFFICE_ID, MLC.YEAR, MLC.MONTH
                UNION ALL
                --其他分摊费用
                SELECT MOS.OFFICE_ID AS ORG_CODE,
                       MOS.YEAR AS CUR_YEAR,
                       MOS.MONTH AS CUR_MONTH,
                       SUM(MONEY) / 10000 AS MONEY
                  FROM MONITOR_OTHER_SHARE MOS
                 GROUP BY OFFICE_ID, MOS.YEAR, MOS.MONTH
                UNION ALL
                --非项目费用
                SELECT ORG_CODE,
                       TO_NUMBER(CUR_YEAR) AS CUR_YEAR,
                       TO_NUMBER(CUR_MONTH) AS CUR_MONTH,
                       SUM(MONEY) / 10000 AS MONEY
                  FROM (SELECT NPBH.OFFICE_ID AS ORG_CODE,
                               TO_CHAR(VBD48.CERTIFICATE_CREATE_TIME, 'yyyy') AS CUR_YEAR,
                               TO_CHAR(VBD48.CERTIFICATE_CREATE_TIME, 'mm') AS CUR_MONTH,
                               VBD48.MONEY
                          FROM (SELECT NVL(NVL(FAD_CASH_REQ_INVOICE.FAD_INVOICE_ID,
                                               SCM_CONTRACT_INVOICE.FAD_INVOICE_ID),
                                           VBD48.UUID) UUID,
                                       VBD48.CERTIFICATE_CREATE_TIME,
                                       VBD48.BUDGET_C_UUID,
                                       VBD48.SUBJECT_NAME,
                                       NVL(VBD48.MONEY, 0) MONEY
                                  FROM VW_BUDGET_DETAIL49 VBD48
                                  LEFT JOIN FAD_CASH_REQ_INVOICE ON VBD48.UUID =
                                                                    FAD_CASH_REQ_INVOICE.UUID
                                  LEFT JOIN SCM_CONTRACT_INVOICE ON VBD48.UUID =
                                                                    SCM_CONTRACT_INVOICE.UUID
                                 WHERE NVL(VBD48.IS_PROJECT, 0) != 1
                                   AND VBD48.BUDGET_C_UUID IS NOT NULL) VBD48
                          LEFT JOIN NON_PROJECT_BUDGET_C NPBC ON VBD48.BUDGET_C_UUID =
                                                                 NPBC.UUID
                          LEFT JOIN NON_PROJECT_BUDGET_H NPBH ON NPBC.HID =
                                                                 NPBH.UUID) R
                 GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH) R
         WHERE EXISTS (SELECT 1
                  FROM OPERATE_COMPANY_PLAN_H H
                  LEFT JOIN OPERATE_COMPANY_PLAN_C C ON H.UUID =
                                                        C.OPERATE_COMPANY_PLAN_H_ID
                 WHERE H.START_YEAR = R.CUR_YEAR
                   AND C.OBJECT_ID = R.ORG_CODE)
         GROUP BY R.ORG_CODE, R.CUR_YEAR, R.CUR_MONTH) QTCB
--结算利润
  FULL JOIN (SELECT NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE) AS ORG_CODE,
             NVL(JS.CUR_YEAR,XZ.CUR_YEAR) AS CUR_YEAR,
             NVL(JS.CUR_MONTH,XZ.CUR_MONTH) AS CUR_MONTH,
                    '结算利润' AS TARGET,
                    SUM(NVL(JSLR, 0) - NVL(SJXZ, 0)) / 10000 AS JSLR
               FROM (SELECT DEPARTMENT_CODE,
                            CUR_YEAR,
                            CUR_MONTH,
                            SUM(JSLR) AS JSLR
                       FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                    TO_CHAR(T.EXAM_DATE, 'YYYY') AS CUR_YEAR,
                                    TO_CHAR(T.EXAM_DATE, 'MM') AS CUR_MONTH,
                                    NVL(T. SQUARE_GROSS_PROFIT, 0)+
                                       NVL(T.TAX_CORRECTION, 0) AS JSLR --利润
                               FROM PRM_FINAL_ESTIMATE T
                              WHERE T.EXAM_DATE IS NOT NULL
                              AND NOT EXISTS
              (SELECT 1
                       FROM PRM_PROJECT_MAIN PPM
                      WHERE PPM.UUID = T.PRM_PROJECT_MAIN_ID
                        AND SUBSTR(PPM.PROJECT_CODE, 0, 1) = '研')) R
                      GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) JS
               FULL JOIN (SELECT DEPARTMENT_CODE,
                                CUR_YEAR,
                                CUR_MONTH,
                                SUM(SJXZ) AS SJXZ
                           FROM (SELECT T.DEPARTMENT_CODE AS DEPARTMENT_CODE,
                                        TO_CHAR(T.EXAM_R_TAX_DATE, 'YYYY') AS CUR_YEAR,
                                        TO_CHAR(T.EXAM_R_TAX_DATE, 'MM') AS CUR_MONTH,
                                        T.TAX_CORRECTION AS SJXZ --税金修正
                                   FROM PRM_FINAL_ESTIMATE T
                                  WHERE T.EXAM_R_TAX_DATE IS NOT NULL
                                  AND NOT EXISTS
              (SELECT 1
                       FROM PRM_PROJECT_MAIN PPM
                      WHERE PPM.UUID = T.PRM_PROJECT_MAIN_ID
                        AND SUBSTR(PPM.PROJECT_CODE, 0, 1) = '研')) R
                          GROUP BY DEPARTMENT_CODE, CUR_YEAR, CUR_MONTH) XZ ON JS.
              DEPARTMENT_CODE =
                                                                          XZ.DEPARTMENT_CODE
                                                                      AND JS.
              CUR_YEAR =
                                                                          XZ.CUR_YEAR
                                                                      AND JS.
              CUR_MONTH =
                                                                          XZ.CUR_MONTH
              GROUP BY NVL(JS.DEPARTMENT_CODE,XZ.DEPARTMENT_CODE), NVL(JS.CUR_YEAR,XZ.CUR_YEAR), NVL(JS.CUR_MONTH,XZ.CUR_MONTH)) JSLR ON JSLR.ORG_CODE =
                                                                                 QTCB.ORG_CODE
                                                                             AND JSLR.CUR_YEAR =
                                                                                 QTCB.CUR_YEAR
                                                                             AND JSLR.CUR_MONTH =
                                                                                 QTCB.CUR_MONTH
                 
                 ) R
         GROUP BY R.ORG_CODE, R.CUR_YEAR) R

 RIGHT JOIN ( --指标
             SELECT OBJECT_ID AS ORG_CODE,
                     H.START_YEAR AS CUR_YEAR,
                     '合同额' AS TARGET,
                     C.JHHTE AS MONEY_JH, --合同额（万元）
                     NVL(C.JZHTE,0)+NVL(C.HTEXZ,0) AS JZ --结转+修正
               FROM OPERATE_COMPANY_PLAN_H H, OPERATE_COMPANY_PLAN_C C
              WHERE H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
             UNION ALL
             --立项利润
             SELECT OBJECT_ID AS ORG_CODE,
                    H.START_YEAR AS CUR_YEAR,
                    '立项利润' AS TARGET,
                    C.JHLXLR,
                    NVL(C.JZLR,0)+NVL(C.lxlrxz,0) AS JZ --结转+修正
               FROM OPERATE_COMPANY_PLAN_H H, OPERATE_COMPANY_PLAN_C C
              WHERE H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
             UNION ALL
             --收款
             SELECT OBJECT_ID AS ORG_CODE,
                    H.START_YEAR AS CUR_YEAR,
                    '收款' AS TARGET,
                    C.JHSR,
                    NVL(JZSR,0)+NVL(BMSRXZ,0) AS JZ --结转+修正
               FROM OPERATE_COMPANY_PLAN_H H, OPERATE_COMPANY_PLAN_C C
              WHERE H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
             UNION ALL
             --结算收入
             SELECT OBJECT_ID AS ORG_CODE,
                    H.START_YEAR AS CUR_YEAR,
                    '结算收入' AS TARGET,
                    C.JHJSSR,
                    BMJSSRXZ AS JZ --结转+修正
               FROM OPERATE_COMPANY_PLAN_H H, OPERATE_COMPANY_PLAN_C C
              WHERE H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
             UNION ALL
             --结算利润
             SELECT OBJECT_ID AS ORG_CODE,
                    H.START_YEAR AS CUR_YEAR,
                    '结算利润' AS TARGET,
                    C.JHJSLR,
                    BMJSLRXZ AS JZ --结转+修正
               FROM OPERATE_COMPANY_PLAN_H H, OPERATE_COMPANY_PLAN_C C
              WHERE H.UUID = C.OPERATE_COMPANY_PLAN_H_ID
             UNION ALL
             --收支盈余
             SELECT OBJECT_ID AS ORG_CODE,
                    H.START_YEAR AS CUR_YEAR,
                    '收支盈余' AS TARGET,
                    C.JHSZYY,
                    BMJSLRXZ AS JZ --结转+修正
               FROM OPERATE_COMPANY_PLAN_H H, OPERATE_COMPANY_PLAN_C C
              WHERE H.UUID = C.OPERATE_COMPANY_PLAN_H_ID) JH ON R.ORG_CODE =
                                                                JH.ORG_CODE
                                                            AND R.CUR_YEAR =
                                                                JH.CUR_YEAR
                                                            AND R.TARGET =
                                                                JH.TARGET
  LEFT JOIN (SELECT SO.SHORT_CODE,SO.ORG_CODE,DECODE(SO.ORG_CODE,'CSNT_ZCB','9999',SO.SEQ_NO) AS SEQ_NO  FROM  SCDP_ORG SO) SO ON SO.ORG_CODE = NVL(R.ORG_CODE, JH.ORG_CODE)
 WHERE R.CUR_YEAR = ${if(year =='',"TO_CHAR(SYSDATE, 'yyyy')","'"+year+"'")}
   AND R.TARGET = '${target}'
 ORDER BY SO.SEQ_NO]]></Query>
</TableData>
</TableDataMap>
<ReportWebAttr>
<ServerPrinter/>
<WebPageContent>
<ToolBars/>
<WebPage isPage="false" isShowAsImage="false" isAutoScale="false" isTDHeavy="false"/>
</WebPageContent>
</ReportWebAttr>
<Report class="com.fr.report.poly.PolyWorkSheet" name="sheet1">
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0">
<PaperSetting>
<PaperSize width="43200000" height="31680000"/>
<Margin top="288000" left="864000" bottom="864000" right="864000"/>
</PaperSetting>
</ReportSettings>
</ReportAttrSet>
<Block class="com.fr.report.poly.PolyECBlock">
<ReportPageAttr>
<HR/>
<FR/>
<HC/>
<FC/>
</ReportPageAttr>
<ColumnPrivilegeControl/>
<RowPrivilegeControl/>
<RowHeight defaultValue="723900">
<![CDATA[723900,723900,723900,723900,723900,723900,723900,723900,723900,723900,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[0,4724400,3276600,3200400,2743200,2743200,2743200,2743200,2743200,2743200,2743200]]></ColumnWidth>
<CellElementList>
<C c="0" r="0">
<PrivilegeControl/>
<Expand/>
</C>
<C c="1" r="0" cs="4" s="0">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="各事业部财务指标完成情况（" + nvl($target, "合同额") + "）"]]></Attributes>
</O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand/>
</C>
<C c="1" r="1">
<O>
<![CDATA[]]></O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand/>
</C>
<C c="2" r="1">
<O>
<![CDATA[]]></O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand/>
</C>
<C c="3" r="1">
<O>
<![CDATA[]]></O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand/>
</C>
<C c="4" r="1" s="1">
<O>
<![CDATA[单位：万元]]></O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand/>
</C>
<C c="0" r="2" s="2">
<O>
<![CDATA[部门编码]]></O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand/>
</C>
<C c="1" r="2" s="2">
<O>
<![CDATA[部门名称]]></O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand/>
</C>
<C c="2" r="2" s="2">
<O>
<![CDATA[计划额]]></O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand/>
</C>
<C c="3" r="2" s="2">
<O>
<![CDATA[完成额]]></O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand/>
</C>
<C c="4" r="2" s="2">
<O>
<![CDATA[完成比例]]></O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand/>
</C>
<C c="0" r="3" s="3">
<O t="DSColumn">
<Attributes dsName="T2" columnName="ORG_CODE"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand dir="0"/>
</C>
<C c="1" r="3" s="4">
<O t="DSColumn">
<Attributes dsName="T2" columnName="ORG_NAME"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript1">
<JavaScript class="com.fr.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="officeId"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=A4]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="officeIdDesc"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B4]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="year"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=year]]></Attributes>
</O>
</Parameter>
</Parameters>
<Content>
<![CDATA[parent.postMessage('BmndcwzbwcjdFromNdcwzbwcjd,'+officeId+','+officeIdDesc+','+year,'*');]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellPageAttr/>
<Expand dir="0"/>
</C>
<C c="2" r="3" s="5">
<O t="DSColumn">
<Attributes dsName="T2" columnName="MONEY_JH"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand dir="0"/>
</C>
<C c="3" r="3" s="5">
<O t="DSColumn">
<Attributes dsName="T2" columnName="MONEY"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand dir="0"/>
</C>
<C c="4" r="3" s="6">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=if(or(C4 = 0, D4 = 0), "-", D4 / C4)]]></Attributes>
</O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand/>
</C>
<C c="0" r="4" s="7">
<PrivilegeControl/>
<CellPageAttr/>
<Expand/>
</C>
<C c="1" r="4" s="7">
<O>
<![CDATA[总计]]></O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand/>
</C>
<C c="2" r="4" s="8">
<O t="DSColumn">
<Attributes dsName="T2_TOTAL" columnName="MONEY_JH"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand dir="0"/>
</C>
<C c="3" r="4" s="8">
<O t="DSColumn">
<Attributes dsName="T2_TOTAL" columnName="MONEY"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand dir="0"/>
</C>
<C c="4" r="4" s="9">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=D5 / C5]]></Attributes>
</O>
<PrivilegeControl/>
<CellPageAttr/>
<Expand/>
</C>
</CellElementList>
<PECBAttr blockName="block2" x="24384000" y="762000" width="13944600" height="3619500"/>
</Block>
<Block class="com.fr.report.poly.PolyChartBlock">
<PCBAttr blockName="block4" x="24384000" y="5105400" width="15240000" height="11430000"/>
<CC>
<LayoutAttr selectedIndex="0"/>
<Chart name="默认" chartClass="com.fr.chart.chartattr.Chart">
<Chart class="com.fr.chart.chartattr.Chart">
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="0" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-6908266"/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<ChartAttr isJSDraw="true" isStyleGlobal="false"/>
<Title>
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="0" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-6908266"/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="各事业部完成占比（"+nvl($target,"合同额")+"）"]]></Attributes>
</O>
<TextAttr>
<Attr alignText="0">
<FRFont name="微软雅黑" style="0" size="112"/>
</Attr>
</TextAttr>
<TitleVisible value="true" position="0"/>
</Title>
<Plot class="com.fr.chart.chartattr.PiePlot">
<Plot>
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="0" isRoundBorder="false" roundRadius="0"/>
<newColor/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<Attr isNullValueBreak="true" autoRefreshPerSecond="-1" seriesDragEnable="false" plotStyle="1" combinedSize="50.0"/>
<newHotTooltipStyle>
<AttrContents>
<Attr showLine="false" position="1" isWhiteBackground="true" isShowMutiSeries="false" seriesLabel="${SERIES}${BR}${CATEGORY}${BR}${VALUE}"/>
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#,##0.00]]></Format>
<PercentFormat>
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#.##%]]></Format>
</PercentFormat>
</AttrContents>
</newHotTooltipStyle>
<ConditionCollection>
<DefaultAttr class="com.fr.chart.chartglyph.ConditionAttr">
<ConditionAttr name="">
<AttrList>
<Attr class="com.fr.chart.base.AttrBorder">
<AttrBorder>
<Attr lineStyle="1" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-1"/>
</AttrBorder>
</Attr>
<Attr class="com.fr.chart.base.AttrContents">
<AttrContents>
<Attr showLine="true" position="6" isWhiteBackground="true" isShowMutiSeries="false" seriesLabel="${PERCENT}"/>
<TextAttr>
<Attr alignText="0">
<FRFont name="宋体" style="0" size="72"/>
</Attr>
</TextAttr>
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#,##0.00]]></Format>
<PercentFormat>
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#0.00%]]></Format>
</PercentFormat>
</AttrContents>
</Attr>
</AttrList>
</ConditionAttr>
</DefaultAttr>
</ConditionCollection>
<Legend>
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="0" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-6908266"/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<Attr position="4" visible="true"/>
<FRFont name="Microsoft YaHei" style="0" size="72"/>
</Legend>
<DataSheet>
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="1" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-16777216"/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<Attr isVisible="false"/>
</DataSheet>
<newPlotFillStyle>
<AttrFillStyle>
<AFStyle colorStyle="1"/>
<FillStyleName fillStyleName="复古"/>
<isCustomFillStyle isCustomFillStyle="false"/>
<ColorList>
<OColor colvalue="-16285489"/>
<OColor colvalue="-9023483"/>
<OColor colvalue="-365283"/>
<OColor colvalue="-15848318"/>
<OColor colvalue="-4803297"/>
<OColor colvalue="-2482408"/>
<OColor colvalue="-9430938"/>
<OColor colvalue="-755083"/>
<OColor colvalue="-16736846"/>
<OColor colvalue="-16626863"/>
<OColor colvalue="-16285489"/>
<OColor colvalue="-9023483"/>
<OColor colvalue="-365283"/>
<OColor colvalue="-15848318"/>
<OColor colvalue="-4803297"/>
<OColor colvalue="-2482408"/>
<OColor colvalue="-9430938"/>
<OColor colvalue="-755083"/>
<OColor colvalue="-16736846"/>
<OColor colvalue="-16626863"/>
<OColor colvalue="-16285489"/>
<OColor colvalue="-9023483"/>
<OColor colvalue="-365283"/>
<OColor colvalue="-15848318"/>
<OColor colvalue="-4803297"/>
<OColor colvalue="-2482408"/>
<OColor colvalue="-9430938"/>
<OColor colvalue="-755083"/>
<OColor colvalue="-16736846"/>
<OColor colvalue="-16626863"/>
<OColor colvalue="-16285489"/>
<OColor colvalue="-9023483"/>
</ColorList>
</AttrFillStyle>
</newPlotFillStyle>
<PieAttr subType="1" smallPercent="0.05"/>
</Plot>
</Plot>
<DataProcessor class="com.fr.base.chart.chartdata.model.NormalDataModel"/>
<ChartDefinition>
<OneValueCDDefinition seriesName="ORG_NAME" valueName="MONEY" function="com.fr.data.util.function.NoneFunction">
<Top topCate="-1" topValue="-1" isDiscardOtherCate="false" isDiscardOtherSeries="false" isDiscardNullCate="false" isDiscardNullSeries="false"/>
<TableData class="com.fr.data.impl.NameTableData">
<Name>
<![CDATA[T4]]></Name>
</TableData>
<CategoryName value=""/>
</OneValueCDDefinition>
</ChartDefinition>
</Chart>
</Chart>
</CC>
</Block>
<Block class="com.fr.report.poly.PolyChartBlock">
<PCBAttr blockName="block5" x="0" y="11887200" width="22860000" height="11430000"/>
<CC>
<LayoutAttr selectedIndex="0"/>
<Chart name="默认" chartClass="com.fr.chart.chartattr.Chart">
<Chart class="com.fr.chart.chartattr.Chart">
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="0" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-6908266"/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<ChartAttr isJSDraw="true" isStyleGlobal="false"/>
<Title>
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="0" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-6908266"/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="公司财务指标月度完成情况（"+nvl($target,"合同额")+"）"]]></Attributes>
</O>
<TextAttr>
<Attr alignText="0">
<FRFont name="微软雅黑" style="0" size="112"/>
</Attr>
</TextAttr>
<TitleVisible value="true" position="0"/>
</Title>
<Plot class="com.fr.chart.chartattr.LinePlot">
<CategoryPlot>
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="0" isRoundBorder="false" roundRadius="0"/>
<newColor/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<Attr isNullValueBreak="true" autoRefreshPerSecond="-1" seriesDragEnable="false" plotStyle="0" combinedSize="50.0"/>
<newHotTooltipStyle>
<AttrContents>
<Attr showLine="false" position="1" isWhiteBackground="true" isShowMutiSeries="false" seriesLabel="${SERIES}${BR}${CATEGORY}${BR}${VALUE}"/>
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#,##0.00万元]]></Format>
<PercentFormat>
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#0.##%]]></Format>
</PercentFormat>
</AttrContents>
</newHotTooltipStyle>
<ConditionCollection>
<DefaultAttr class="com.fr.chart.chartglyph.ConditionAttr">
<ConditionAttr name="">
<AttrList>
<Attr class="com.fr.chart.base.AttrContents">
<AttrContents>
<Attr showLine="false" position="1" isWhiteBackground="true" isShowMutiSeries="false" seriesLabel=""/>
<TextAttr>
<Attr alignText="0">
<FRFont name="宋体" style="0" size="72"/>
</Attr>
</TextAttr>
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#,##0.00万元]]></Format>
<PercentFormat>
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#.##%]]></Format>
</PercentFormat>
</AttrContents>
</Attr>
<Attr class="com.fr.chart.base.AttrLineStyle">
<AttrLineStyle>
<newAttr lineStyle="5"/>
</AttrLineStyle>
</Attr>
<Attr class="com.fr.chart.base.AttrMarkerType">
<AttrMarkerType>
<Attr markerType="RoundFilledMarker"/>
</AttrMarkerType>
</Attr>
</AttrList>
</ConditionAttr>
</DefaultAttr>
</ConditionCollection>
<Legend>
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="0" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-6908266"/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<Attr position="3" visible="true"/>
<FRFont name="微软雅黑" style="0" size="48"/>
</Legend>
<DataSheet>
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="1" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-16777216"/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<Attr isVisible="false"/>
</DataSheet>
<newPlotFillStyle>
<AttrFillStyle>
<AFStyle colorStyle="1"/>
<FillStyleName fillStyleName=""/>
<isCustomFillStyle isCustomFillStyle="true"/>
<ColorList>
<OColor colvalue="-65536"/>
<OColor colvalue="-16777216"/>
<OColor colvalue="-13108"/>
<OColor colvalue="-6710887"/>
<OColor colvalue="-3658447"/>
<OColor colvalue="-10331231"/>
<OColor colvalue="-7763575"/>
<OColor colvalue="-6514688"/>
<OColor colvalue="-16744620"/>
<OColor colvalue="-6187579"/>
<OColor colvalue="-15714713"/>
<OColor colvalue="-945550"/>
<OColor colvalue="-4092928"/>
<OColor colvalue="-13224394"/>
<OColor colvalue="-12423245"/>
<OColor colvalue="-10043521"/>
<OColor colvalue="-406154"/>
<OColor colvalue="-13031292"/>
<OColor colvalue="-16732559"/>
<OColor colvalue="-7099690"/>
<OColor colvalue="-11991199"/>
<OColor colvalue="-331445"/>
<OColor colvalue="-6991099"/>
<OColor colvalue="-16686527"/>
<OColor colvalue="-9205567"/>
<OColor colvalue="-7397856"/>
<OColor colvalue="-406154"/>
<OColor colvalue="-2712831"/>
<OColor colvalue="-4737097"/>
<OColor colvalue="-11460720"/>
<OColor colvalue="-6696775"/>
<OColor colvalue="-3685632"/>
</ColorList>
</AttrFillStyle>
</newPlotFillStyle>
<RectanglePlotAttr interactiveAxisTooltip="false"/>
<xAxis>
<CategoryAxis class="com.fr.chart.chartattr.CategoryAxis">
<Title>
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="0" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-16777216"/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<O>
<![CDATA[坐标轴标题]]></O>
<TextAttr>
<Attr alignText="0">
<FRFont name="微软雅黑" style="0" size="72"/>
</Attr>
</TextAttr>
<TitleVisible value="false" position="0"/>
</Title>
<newAxisAttr isShowAxisLabel="true"/>
<AxisLineStyle AxisStyle="1" MainGridStyle="0"/>
<newLineColor mainGridColor="-4144960" lineColor="-5197648"/>
<AxisPosition value="3"/>
<TickLine201106 type="2" secType="0"/>
<ArrowShow arrowShow="false"/>
<TextAttr>
<Attr alignText="0">
<FRFont name="微软雅黑" style="0" size="72"/>
</Attr>
</TextAttr>
<AxisLabelCount value="=0"/>
<AxisRange/>
<AxisUnit201106 isCustomMainUnit="false" isCustomSecUnit="false" mainUnit="=0" secUnit="=0"/>
<ZoomAxisAttr isZoom="false"/>
<axisReversed axisReversed="false"/>
</CategoryAxis>
</xAxis>
<yAxis>
<ValueAxis class="com.fr.chart.chartattr.ValueAxis">
<ValueAxisAttr201108 alignZeroValue="false"/>
<Title>
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="0" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-16777216"/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<O>
<![CDATA[单位：万元]]></O>
<TextAttr>
<Attr alignText="1">
<FRFont name="微软雅黑" style="0" size="72"/>
</Attr>
</TextAttr>
<TitleVisible value="true" position="2"/>
</Title>
<newAxisAttr isShowAxisLabel="true"/>
<AxisLineStyle AxisStyle="1" MainGridStyle="1"/>
<newLineColor mainGridColor="-4144960" lineColor="-5197648"/>
<AxisPosition value="2"/>
<TickLine201106 type="2" secType="0"/>
<ArrowShow arrowShow="false"/>
<TextAttr>
<Attr alignText="0">
<FRFont name="Century Gothic" style="0" size="72"/>
</Attr>
</TextAttr>
<AxisLabelCount value="=0"/>
<AxisRange/>
<AxisUnit201106 isCustomMainUnit="false" isCustomSecUnit="false" mainUnit="=0" secUnit="=0"/>
<ZoomAxisAttr isZoom="false"/>
<axisReversed axisReversed="false"/>
</ValueAxis>
</yAxis>
<secondAxis>
<ValueAxis class="com.fr.chart.chartattr.ValueAxis">
<ValueAxisAttr201108 alignZeroValue="false"/>
<newAxisAttr isShowAxisLabel="true"/>
<AxisLineStyle AxisStyle="1" MainGridStyle="1"/>
<newLineColor mainGridColor="-4144960" lineColor="-5197648"/>
<AxisPosition value="4"/>
<TickLine201106 type="2" secType="0"/>
<ArrowShow arrowShow="false"/>
<TextAttr>
<Attr alignText="0">
<FRFont name="Century Gothic" style="0" size="72"/>
</Attr>
</TextAttr>
<AxisLabelCount value="=0"/>
<AxisRange/>
<AxisUnit201106 isCustomMainUnit="false" isCustomSecUnit="false" mainUnit="=0" secUnit="=0"/>
<ZoomAxisAttr isZoom="false"/>
<axisReversed axisReversed="false"/>
</ValueAxis>
</secondAxis>
<CateAttr isStacked="false"/>
<Show Curve="true"/>
</CategoryPlot>
</Plot>
<DataProcessor class="com.fr.base.chart.chartdata.model.NormalDataModel"/>
<ChartDefinition>
<MoreNameCDDefinition>
<Top topCate="-1" topValue="-1" isDiscardOtherCate="false" isDiscardOtherSeries="false" isDiscardNullCate="false" isDiscardNullSeries="false"/>
<TableData class="com.fr.data.impl.NameTableData">
<Name>
<![CDATA[T3]]></Name>
</TableData>
<CategoryName value="CUR_MONTH"/>
<ChartSummaryColumn name="MONEY" function="com.fr.data.util.function.SumFunction" customName="今年当期完成额"/>
<ChartSummaryColumn name="MONEY_LJ" function="com.fr.data.util.function.SumFunction" customName="今年当期累计完成额"/>
<ChartSummaryColumn name="L_MONEY" function="com.fr.data.util.function.SumFunction" customName="去年同期完成额"/>
<ChartSummaryColumn name="L_MONEY_LJ" function="com.fr.data.util.function.SumFunction" customName="去年同期累计完成额"/>
</MoreNameCDDefinition>
</ChartDefinition>
</Chart>
</Chart>
</CC>
</Block>
<Block class="com.fr.report.poly.PolyECBlock">
<ReportPageAttr>
<HR/>
<FR/>
<HC/>
<FC/>
</ReportPageAttr>
<ColumnPrivilegeControl/>
<RowPrivilegeControl/>
<RowHeight defaultValue="723900">
<![CDATA[838200,838200,723900,723900,723900,723900,723900,723900,723900,723900,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[2743200,2743200,2743200,2743200,2743200,2743200,2743200,2743200,2743200,2743200,2743200]]></ColumnWidth>
<CellElementList>
<C c="0" r="0" cs="8" s="10">
<O>
<![CDATA[备注：]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="0" r="1" cs="8" s="10">
<O t="DSColumn">
<Attributes dsName="REMARK" columnName="REMARK"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="0" r="2" cs="8" s="11">
<O>
<![CDATA[经营合同汇总表(考核)]]></O>
<PrivilegeControl/>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript1">
<JavaScript class="com.fr.js.JavaScriptImpl">
<Parameters/>
<Content>
<![CDATA[parent.postMessage('ErpopreportygbjyhthzbkhFromNdcwzbwcjd','*');]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand/>
</C>
<C c="0" r="3" cs="8" s="11">
<O>
<![CDATA[项目立项汇总表(考核)]]></O>
<PrivilegeControl/>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript1">
<JavaScript class="com.fr.js.JavaScriptImpl">
<Parameters/>
<Content>
<![CDATA[parent.postMessage('ErpopreportygbxmlxhzbkhzFromNdcwzbwcjd','*');]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand/>
</C>
<C c="0" r="4" cs="8" s="11">
<O>
<![CDATA[项目结算汇总表(考核)]]></O>
<PrivilegeControl/>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript1">
<JavaScript class="com.fr.js.JavaScriptImpl">
<Parameters/>
<Content>
<![CDATA[parent.postMessage('Erpopreportygb9zdFromNdcwzbwcjd','*');]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand/>
</C>
<C c="0" r="5" cs="8" s="11">
<O>
<![CDATA[收款汇总表(考核)]]></O>
<PrivilegeControl/>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript1">
<JavaScript class="com.fr.js.JavaScriptImpl">
<Parameters/>
<Content>
<![CDATA[parent.postMessage('ReportskhzbkhzFromNdcwzbwcjd','*');]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand/>
</C>
<C c="0" r="6" cs="8" s="11">
<O>
<![CDATA[收支盈余汇总表(考核)]]></O>
<PrivilegeControl/>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript1">
<JavaScript class="com.fr.js.JavaScriptImpl">
<Parameters/>
<Content>
<![CDATA[parent.postMessage('ReportszyykhzFromNdcwzbwcjd','*');]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand/>
</C>
<C c="0" r="7" cs="8" s="11">
<O>
<![CDATA[在册项目汇总表]]></O>
<PrivilegeControl/>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript1">
<JavaScript class="com.fr.js.JavaScriptImpl">
<Parameters/>
<Content>
<![CDATA[parent.postMessage('Erpopreportygb4zFromNdcwzbwcjd','*');]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand/>
</C>
</CellElementList>
<PECBAttr blockName="block3" x="457200" y="24422100" width="21945600" height="6019800"/>
</Block>
<Block class="com.fr.report.poly.PolyChartBlock">
<PCBAttr blockName="block1" x="0" y="114300" width="22860000" height="11468100"/>
<CC>
<LayoutAttr selectedIndex="0"/>
<Chart name="默认" chartClass="com.fr.chart.chartattr.Chart">
<Chart class="com.fr.chart.chartattr.Chart">
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="0" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-6908266"/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<ChartAttr isJSDraw="true" isStyleGlobal="false"/>
<Title>
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="0" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-16777216"/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=year+"年公司财务指标总体完成进度"]]></Attributes>
</O>
<TextAttr>
<Attr alignText="0">
<FRFont name="微软雅黑" style="0" size="112"/>
</Attr>
</TextAttr>
<TitleVisible value="true" position="0"/>
</Title>
<Plot class="com.fr.chart.chartattr.Bar2DPlot">
<CategoryPlot>
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="0" isRoundBorder="false" roundRadius="0"/>
<newColor/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<Attr isNullValueBreak="true" autoRefreshPerSecond="-1" seriesDragEnable="false" plotStyle="0" combinedSize="50.0"/>
<newHotTooltipStyle>
<AttrContents>
<Attr showLine="false" position="1" isWhiteBackground="true" isShowMutiSeries="false" seriesLabel="${SERIES}${BR}${CATEGORY}${BR}${VALUE}"/>
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#0.00%]]></Format>
<PercentFormat>
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#0.##%]]></Format>
</PercentFormat>
</AttrContents>
</newHotTooltipStyle>
<ConditionCollection>
<DefaultAttr class="com.fr.chart.chartglyph.ConditionAttr">
<ConditionAttr name="">
<AttrList>
<Attr class="com.fr.chart.base.AttrContents">
<AttrContents>
<Attr showLine="false" position="6" isWhiteBackground="true" isShowMutiSeries="false" seriesLabel="${CATEGORY},${VALUE}"/>
<TextAttr>
<Attr alignText="0">
<FRFont name="宋体" style="0" size="72"/>
</Attr>
</TextAttr>
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#0.00%]]></Format>
<PercentFormat>
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#.##%]]></Format>
</PercentFormat>
</AttrContents>
</Attr>
</AttrList>
</ConditionAttr>
</DefaultAttr>
</ConditionCollection>
<Legend>
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="0" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-6908266"/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<Attr position="3" visible="false"/>
<FRFont name="微软雅黑" style="0" size="72"/>
</Legend>
<DataSheet>
<GI>
<AttrBackground>
<Background name="NullBackground"/>
<Attr shadow="false"/>
</AttrBackground>
<AttrBorder>
<Attr lineStyle="1" isRoundBorder="false" roundRadius="0"/>
<newColor borderColor="-16777216"/>
</AttrBorder>
<AttrAlpha>
<Attr alpha="1.0"/>
</AttrAlpha>
</GI>
<Attr isVisible="false"/>
</DataSheet>
<NameJavaScriptGroup>
<NameJavaScript name="动态参数1">
<JavaScript class="com.fr.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="target"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=CATEGORY]]></Attributes>
</O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<newPlotFillStyle>
<AttrFillStyle>
<AFStyle colorStyle="0"/>
<FillStyleName fillStyleName=""/>
<isCustomFillStyle isCustomFillStyle="false"/>
</AttrFillStyle>
</newPlotFillStyle>
<RectanglePlotAttr interactiveAxisTooltip="false"/>
<xAxis>
<CategoryAxis class="com.fr.chart.chartattr.CategoryAxis">
<newAxisAttr isShowAxisLabel="true"/>
<AxisLineStyle AxisStyle="1" MainGridStyle="0"/>
<newLineColor mainGridColor="-4144960" lineColor="-5197648"/>
<AxisPosition value="3"/>
<TickLine201106 type="2" secType="0"/>
<ArrowShow arrowShow="false"/>
<TextAttr>
<Attr alignText="0">
<FRFont name="微软雅黑" style="0" size="72"/>
</Attr>
</TextAttr>
<AxisLabelCount value="=0"/>
<AxisRange/>
<AxisUnit201106 isCustomMainUnit="false" isCustomSecUnit="false" mainUnit="=0" secUnit="=0"/>
<ZoomAxisAttr isZoom="false"/>
<axisReversed axisReversed="false"/>
</CategoryAxis>
</xAxis>
<yAxis>
<ValueAxis class="com.fr.chart.chartattr.ValueAxis">
<ValueAxisAttr201108 alignZeroValue="false"/>
<newAxisAttr isShowAxisLabel="true"/>
<AxisLineStyle AxisStyle="1" MainGridStyle="1"/>
<newLineColor mainGridColor="-4144960" lineColor="-5197648"/>
<AxisPosition value="2"/>
<TickLine201106 type="2" secType="0"/>
<ArrowShow arrowShow="false"/>
<TextAttr>
<Attr alignText="0">
<FRFont name="Century Gothic" style="0" size="72"/>
</Attr>
</TextAttr>
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#0%]]></Format>
<AxisLabelCount value="=0"/>
<AxisRange/>
<AxisUnit201106 isCustomMainUnit="false" isCustomSecUnit="false" mainUnit="=0" secUnit="=0"/>
<ZoomAxisAttr isZoom="false"/>
<axisReversed axisReversed="false"/>
</ValueAxis>
</yAxis>
<secondAxis>
<ValueAxis class="com.fr.chart.chartattr.ValueAxis">
<ValueAxisAttr201108 alignZeroValue="false"/>
<newAxisAttr isShowAxisLabel="true"/>
<AxisLineStyle AxisStyle="1" MainGridStyle="1"/>
<newLineColor mainGridColor="-4144960" lineColor="-5197648"/>
<AxisPosition value="4"/>
<TickLine201106 type="2" secType="0"/>
<ArrowShow arrowShow="false"/>
<TextAttr>
<Attr alignText="0">
<FRFont name="Century Gothic" style="0" size="72"/>
</Attr>
</TextAttr>
<AxisLabelCount value="=0"/>
<AxisRange/>
<AxisUnit201106 isCustomMainUnit="false" isCustomSecUnit="false" mainUnit="=0" secUnit="=0"/>
<ZoomAxisAttr isZoom="false"/>
<axisReversed axisReversed="false"/>
</ValueAxis>
</secondAxis>
<CateAttr isStacked="false"/>
<BarAttr isHorizontal="false" overlap="-0.25" interval="1.0"/>
<Bar2DAttr isSimulation3D="false"/>
</CategoryPlot>
</Plot>
<DataProcessor class="com.fr.base.chart.chartdata.model.NormalDataModel"/>
<ChartDefinition>
<MoreNameCDDefinition>
<Top topCate="-1" topValue="-1" isDiscardOtherCate="false" isDiscardOtherSeries="false" isDiscardNullCate="false" isDiscardNullSeries="false"/>
<TableData class="com.fr.data.impl.NameTableData">
<Name>
<![CDATA[T1]]></Name>
</TableData>
<CategoryName value="TARGET"/>
<ChartSummaryColumn name="WCBL" function="com.fr.data.util.function.NoneFunction" customName="完成比例"/>
</MoreNameCDDefinition>
</ChartDefinition>
</Chart>
</Chart>
</CC>
</Block>
<PrivilegeControl/>
</Report>
<ReportParameterAttr>
<Attributes showWindow="true" delayPlaying="false" windowPosition="1" align="0"/>
<PWTitle>
<![CDATA[参数]]></PWTitle>
<ParameterUI class="com.fr.form.main.parameter.FormParameterUI">
<Parameters/>
<Layout class="com.fr.form.ui.container.WParameterLayout">
<WidgetName name="para"/>
<WidgetAttr>
<PrivilegeControl/>
</WidgetAttr>
<Margin top="0" left="0" bottom="0" right="0"/>
<Border>
<border style="0" color="-723724" type="0" borderStyle="0"/>
<WidgetTitle>
<O>
<![CDATA[新建标题]]></O>
<FRFont name="SimSun" style="0" size="72"/>
<Position pos="0"/>
</WidgetTitle>
<Alpha alpha="1.0"/>
</Border>
<Background name="ColorBackground" color="-1118482"/>
<LCAttr vgap="0" hgap="0" compInterval="0"/>
<Widget class="com.fr.form.ui.container.WAbsoluteLayout$BoundsWidget">
<InnerWidget class="com.fr.form.ui.ComboBox">
<Listener event="afteredit">
<JavaScript class="com.fr.js.JavaScriptImpl">
<Parameters/>
<Content>
<![CDATA[_g().parameterCommit();  ]]></Content>
</JavaScript>
</Listener>
<WidgetName name="year"/>
<WidgetAttr>
<PrivilegeControl/>
</WidgetAttr>
<allowBlank>
<![CDATA[false]]></allowBlank>
<Dictionary class="com.fr.data.impl.TableDataDictionary">
<FormulaDictAttr kiName="SYS_CODE" viName="CODE_DESC"/>
<TableDataDictAttr>
<TableData class="com.fr.data.impl.NameTableData">
<Name>
<![CDATA[year]]></Name>
</TableData>
</TableDataDictAttr>
</Dictionary>
<widgetValue>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=year(today())]]></Attributes>
</O>
</widgetValue>
</InnerWidget>
<BoundsAttr x="77" y="8" width="119" height="21"/>
</Widget>
<Widget class="com.fr.form.ui.container.WAbsoluteLayout$BoundsWidget">
<InnerWidget class="com.fr.form.ui.Label">
<WidgetName name="label0"/>
<WidgetAttr>
<PrivilegeControl/>
</WidgetAttr>
<widgetValue>
<O>
<![CDATA[年度：]]></O>
</widgetValue>
<LabelAttr verticalcenter="true" textalign="0" autoline="true"/>
<FRFont name="SimSun" style="0" size="72"/>
<border style="0" color="-723724"/>
</InnerWidget>
<BoundsAttr x="33" y="8" width="42" height="21"/>
</Widget>
<Sorted sorted="false"/>
<Display display="true"/>
<DelayDisplayContent delay="false"/>
<Position position="0"/>
<Design_Width design_width="960"/>
<MobileWidgetList>
<Widget widgetName="year"/>
</MobileWidgetList>
<WidgetNameTagMap>
<NameTag name="year" tag="年度："/>
</WidgetNameTagMap>
</Layout>
<DesignAttr width="960" height="31"/>
</ParameterUI>
</ReportParameterAttr>
<StyleList>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="微软雅黑" style="0" size="112" foreground="-16764109"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style imageLayout="1">
<FRFont name="微软雅黑" style="0" size="72" foreground="-6908266"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="微软雅黑" style="0" size="80"/>
<Background name="ColorBackground" color="-2171170"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style imageLayout="1">
<FRFont name="微软雅黑" style="0" size="80"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style imageLayout="1">
<FRFont name="微软雅黑" style="0" size="80" foreground="-16776961" underline="1"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style imageLayout="1">
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#,##0.00]]></Format>
<FRFont name="SimSun" style="0" size="80"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style imageLayout="1">
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#0.00%]]></Format>
<FRFont name="SimSun" style="0" size="80"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="微软雅黑" style="0" size="80"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#,##0.00]]></Format>
<FRFont name="微软雅黑" style="0" size="80"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#0.00%]]></Format>
<FRFont name="微软雅黑" style="0" size="80"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style imageLayout="1">
<FRFont name="微软雅黑" style="0" size="96" foreground="-11967371"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style imageLayout="1">
<FRFont name="SimSun" style="0" size="96" foreground="-16776961" underline="1"/>
<Background name="NullBackground"/>
<Border/>
</Style>
</StyleList>
<DesignerVersion DesignerVersion="IAA"/>
<PreviewType PreviewType="0"/>
</WorkBook>
